<!DOCTYPE html>
<html lang="en">

<head>
  <!--Design for website inspired by Chris Albon-->
      <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="Code, Tutorials, and References for Data Science">
    <meta name="author" content="Code, Tutorials, and References for Data Science">
    <link rel="icon" href="../images/favicon.ico">

    <title>Finding a Data Science Job with Data Science - Articles</title>

    <!-- JQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script>
        window.jQuery || document.write('<script src="../theme/js/jquery.min.js"><\/script>')
    </script>

    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="../theme/css/bootstrap.css" />
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <link rel="stylesheet" type="text/css" href="../theme/css/ie10-viewport-bug-workaround.css" />
    <!-- Custom styles for this template -->
    <link rel="stylesheet" type="text/css" href="../theme/css/style.css" />
    <link rel="stylesheet" type="text/css" href="../theme/css/notebooks.css" />
    <link href='https://fonts.googleapis.com/css?family=Montserrat' rel='stylesheet' type='text/css'>
    <link href="https://fonts.googleapis.com/css?family=EB+Garamond" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
        



</head>

<body>

    <div class="navbar navbar-fixed-top">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href=".." style="margin-top: 5px;">INSTANTI-NATE</a>
            </div>
            <div class="navbar-collapse collapse" id="searchbar">

              <ul class="nav navbar-nav navbar-right" style="margin-top: 15px;">
                <!--<li class="dropdown">
                    <a href="../visuals.html" role="button" aria-haspopup="true" aria-expanded="false">Visualizations</a>
                    <ul class="dropdown-menu">
                        <li><a href="">Top Visuals</a></li>
                        <li><a href="./visuals.html">Projects</a></li>
                    </ul>
                </li>-->
                <li class="dropdown">
                      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Data Science<span class="caret"></span></a>
                      <ul class="dropdown-menu">
                          <li><a href="../index.html">Data Wrangling</a></li>
                          <li><a href="../index.html">Data Science</a></li>
                          <li><a href="../index.html">Random</a></li>
                      </ul>
                  <!--</li>
                  <li class="dropdown">
                      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Articles<span class="caret"></span></a>
                        <ul class="dropdown-menu">-->
                  <!--<li><a href="../articles.html">Articles</a></li>-->
                  <li><a href="../portfolio.html">Portfolio</a></li>
                        <!--</ul>
                    </li>-->
                  <li class="dropdown">
                      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About<span class="caret"></span></a>
                      <ul class="dropdown-menu">
                          <li><a href="../pages/about_nate.html">About Nate</a></li>
                          <li><a href="https://github.com/nathan-hall", target="_blank">GitHub</a></li>
                          <li><a href="https://www.linkedin.com/in/nathan-hall-a3ba833a", target="_blank">LinkedIn</a></li>
                      </ul>
                  </li>
              </ul>

                <form class="navbar-form" action="../search.html" onsubmit="return validateForm(this.elements['q'].value);">
                    <div class="form-group" style="display:inline;">
                        <div class="input-group" style="display:table;">
                            <span class="input-group-addon" style="width:1%;"><span class="glyphicon glyphicon-search"></span></span>
                            <input class="form-control search-query" name="q" id="tipue_search_input" placeholder="e.g. scikit KNN, pandas merge" required autocomplete="off" type="text">
                        </div>
                    </div>
                </form>

            </div>
            <!--/.nav-collapse -->
        </div>
    </div>



    <!-- end of header section -->
    <div class="container">
<!-- <div class="alert alert-warning" role="alert">
    Did you find this page useful? Please do me a quick favor and <a href="#" class="alert-link">endorse me for data science on LinkedIn</a>.
</div> -->
<section id="content" class="body">
  <div class="container">
  <div class="col-sm-12">
    <header>
    <h1>
      Finding a Data Science Job with Data Science
    </h1>
<ol class="breadcrumb">
    <li>
        <time class="published" datetime="2017-02-16T12:00:00-05:00">
            16 February 2017
        </time>
    </li>
    <li>Articles</li>
</ol>
</header>
<div class='article_content'>
<p>PROCESS OF METHODS:</p>
<p>SCRAPING
- 1: Scrape jobs from Indeed.com.
- 2: Scrape job descriptions from root job post.
- 3: Scrape employer salary data from Payscale.com.</p>
<p>FILTERING
- 4: Filter down to job posts that have "Data Scientist" in the title.
- 5: Get keywords from these "Data Scientist" job posts by using TFIDF vectorizer.
- 6: Using the TFIDF scores as weights, analyze ALL job posts.
- 7: Use the TFIDF scores for each job post to filter to the most "Data Sciencey" jobs.
- 8: Use the TFIDF score for each keyword in job titles as well.</p>
<p>WEIGHTING
- 9: Extract salary data from job post text for all "Data Sciencey" jobs.
- 10: For each company, calculate the percentage increase from the median salary to the "Data Science" salary.
- TEST: Calculate the percentage increase for keywords in the job titles. (Like Chief, Senior, etc.)</p>
<p>ESTIMATING
- 11: For job posts without salary data, use the Data Science salary weight to estimate a salary for each job post relative to the company.</p>
<p>MODELING
- 12: Run all of the features through a Random Forest model to find what most influences a job being above or below the median salary.
- 13: Run all of the features through a Logistic Regression model. Compare coefficients to feature importance from Random Forest and also adjust the threshold to minimize False Positives.</p>
<p>VISUALIZATIONS
- Several visuals to demonstrate what was done.</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">urllib</span>
<span class="kn">from</span> <span class="nn">readability.readability</span> <span class="kn">import</span> <span class="n">Document</span>
<span class="kn">from</span> <span class="nn">html_table_parser</span> <span class="kn">import</span> <span class="n">parser_functions</span> <span class="k">as</span> <span class="n">parse</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.common.keys</span> <span class="kn">import</span> <span class="n">Keys</span>
<span class="n">chrome_options</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">ChromeOptions</span><span class="p">()</span>
<span class="n">chrome_options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--incognito&quot;</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="kn">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>

<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">LabelEncoder</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">TfidfVectorizer</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.cross_validation</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.cross_validation</span> <span class="kn">import</span> <span class="n">cross_val_score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">classification_report</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">svm</span><span class="p">,</span> <span class="n">linear_model</span>
<span class="kn">from</span> <span class="nn">sklearn.grid_search</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>
</pre></div>


<h1>SCRAPING</h1>
<h3>1: Scrape jobs from Indeed.com</h3>
<p>Below is the indeed scraper that was run to get a dataframe that has title, company name, referral link, salary range/description, and the location of the job posts.</p>
<div class="highlight"><pre><span></span><span class="c1">#Dataframe we will store the collected data.</span>
<span class="n">indeed_jobs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">,</span><span class="s2">&quot;company&quot;</span><span class="p">,</span><span class="s2">&quot;url&quot;</span><span class="p">,</span> <span class="s2">&quot;srange&quot;</span><span class="p">,</span> <span class="s2">&quot;location&quot;</span><span class="p">])</span>
<span class="c1">#Locations we&#39;re going to search through.</span>
<span class="n">locations</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Washington, DC&#39;</span><span class="p">,</span> <span class="s1">&#39;Herndon, VA&#39;</span><span class="p">,</span><span class="s1">&#39;Atlanta, GA&#39;</span><span class="p">,</span> <span class="s1">&#39;New York, NY&#39;</span><span class="p">]</span>
<span class="c1">#Function to run for the search.</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">locations</span><span class="p">:</span>    
    <span class="c1">#open Chrome</span>
    <span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">chrome_options</span><span class="o">=</span><span class="n">chrome_options</span><span class="p">)</span>
    <span class="c1">#navigate to indeed.com</span>
    <span class="n">driver</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;https://www.indeed.com/&quot;</span><span class="p">)</span>
    <span class="c1"># find the search position</span>
    <span class="n">elem</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_name</span><span class="p">(</span><span class="s2">&quot;q&quot;</span><span class="p">)</span>
    <span class="c1"># type in data scientist</span>
    <span class="n">elem</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&quot;Data Scientist&quot;</span><span class="p">)</span>
    <span class="c1"># find the location position</span>
    <span class="n">elem_loc</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_name</span><span class="p">(</span><span class="s2">&quot;l&quot;</span><span class="p">)</span>
    <span class="c1"># clear autofilled data</span>
    <span class="n">elem_loc</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="c1"># type in the next location in my list.</span>
    <span class="n">elem_loc</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="c1"># click search</span>
    <span class="n">elem</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">Keys</span><span class="o">.</span><span class="n">RETURN</span><span class="p">)</span>
    <span class="c1">#close the popup that appears.</span>
    <span class="c1">#driver.find_element_by_xpath(&quot;.//div[@id=&#39;prime-popover-x&#39;]/button&quot;).click()</span>
    <span class="c1">#Filter the search results to only have full-time jobs.</span>
    <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_link_text</span><span class="p">(</span><span class="s1">&#39;Full-time&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
    <span class="c1">#The number of jobs returned from the search. Divide by 10 to get how many times you should click the next button.</span>
    <span class="n">end</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">driver</span><span class="o">.</span><span class="n">page_source</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span><span class="s1">&#39;searchCount&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">partition</span><span class="p">(</span><span class="s1">&#39;of &#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span><span class="o">/</span><span class="mi">12</span>     
    <span class="c1">#Indeed only lets you view the first 1,000 jobs of each search. If more than 1,000 jobs are returned we&#39;ll</span>
    <span class="c1">#adjust the end number to move on after its viewed all that it is allowed.</span>
    <span class="k">if</span> <span class="n">end</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>
        <span class="n">end</span> <span class="o">=</span> <span class="mi">100</span>
    <span class="c1">#Function to return the elements of the search.</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">end</span><span class="p">):</span>
        <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">driver</span><span class="o">.</span><span class="n">page_source</span><span class="p">,</span><span class="s1">&#39;html.parser&#39;</span><span class="p">,</span> <span class="n">from_encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_link_text</span><span class="p">(</span><span class="s1">&#39;No, thanks&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span><span class="s1">&#39;  row  result&#39;</span><span class="p">}):</span>
                <span class="n">title</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
                <span class="n">company</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;span&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;itemprop&#39;</span><span class="p">:</span><span class="s1">&#39;name&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
                <span class="n">location</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;span&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;itemprop&#39;</span><span class="p">:</span><span class="s1">&#39;jobLocation&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
                <span class="n">srange</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">salary</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;td&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span><span class="s1">&#39;snip&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
                    <span class="n">srange</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">salary</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">srange</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
                <span class="c1">#description = entry.find(&#39;span&#39;, {&#39;itemprop&#39;:&#39;description&#39;}).text</span>
                <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;http://indeed.com&quot;</span> <span class="o">+</span> <span class="n">entry</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">)</span>
                <span class="n">indeed_jobs</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">indeed_jobs</span><span class="p">)]</span><span class="o">=</span><span class="p">[</span><span class="n">title</span><span class="p">,</span> <span class="n">company</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">srange</span><span class="p">,</span> <span class="n">location</span><span class="p">]</span>
        <span class="n">sleep</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">5.9</span><span class="p">),</span><span class="mi">1</span><span class="p">)))</span> <span class="c1">#sleep before next step.</span>
        <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_link_text</span><span class="p">(</span><span class="s1">&#39;Next »&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span> <span class="c1">#click the next button for search results.</span>
        <span class="k">print</span> <span class="n">indeed_jobs</span><span class="o">.</span><span class="n">shape</span>
    <span class="c1">#close the driver.</span>
    <span class="n">driver</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="c1">#Remove any duplicated rows.</span>
<span class="k">print</span> <span class="s2">&quot;Shape before duplicates removed =&quot;</span><span class="p">,</span> <span class="n">indeed_jobs</span><span class="o">.</span><span class="n">shape</span>
<span class="n">indeed_jobs</span> <span class="o">=</span> <span class="n">indeed_jobs</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">([</span><span class="s1">&#39;url&#39;</span><span class="p">])</span>
<span class="k">print</span> <span class="s2">&quot;Shape after duplicates removed =&quot;</span><span class="p">,</span><span class="n">indeed_jobs</span><span class="o">.</span><span class="n">shape</span>

<span class="c1">#backup the scraped jobs to csv.</span>
<span class="n">indeed_jobs</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;data/FULL_TIME_INDEED_SCRAPED_DATA_RAW.csv&#39;</span><span class="p">)</span>
</pre></div>


<h3>2: Scrape job descriptions from root job post.</h3>
<div class="highlight"><pre><span></span><span class="c1">#Bring in the scraped csv from the above scraper.</span>
<span class="n">scraper1_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/FULL_TIME_INDEED_SCRAPED_DATA_RAW.csv&#39;</span><span class="p">)</span>
<span class="n">scraper2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scraper1_data</span><span class="p">)</span>
<span class="n">scraper2</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;Unnamed: 0&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">print</span> <span class="n">scraper2</span><span class="o">.</span><span class="n">shape</span>
<span class="n">scraper2</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>(2132, 5)
</pre></div>


<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>title</th>
      <th>company</th>
      <th>url</th>
      <th>srange</th>
      <th>location</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Forensic Scientist (Crime Scene)</td>
      <td>\n    Dept of Forensic Sciences</td>
      <td>http://indeed.com/rc/clk?jk=70192ba18fa061a8&amp;f...</td>
      <td>['\n$61,491 - $79,275 a year\n\n\nAnd knowledg...</td>
      <td>Washington, DC</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Data Scientist</td>
      <td>\n    Excella Consulting</td>
      <td>http://indeed.com/rc/clk?jk=42cb30526e07b4ec&amp;f...</td>
      <td>['\n\n\nUsing machine learning and data mining...</td>
      <td>Washington, DC 20006 (Foggy Bottom area)</td>
    </tr>
  </tbody>
</table>
</div>

<p>Below is the scraper that we used to get the job descriptions and resolve any encoding/formatting errors that arose from those descriptions.</p>
<div class="highlight"><pre><span></span><span class="c1">#A function we will use later to strip out the html tags.</span>
<span class="k">def</span> <span class="nf">striphtml</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">r&#39;&lt;.*?&gt;&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">p</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
<span class="c1">#empty list to hold the job descriptions.</span>
<span class="n">desc</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">scraper2</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">]:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">html</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="n">readable</span> <span class="o">=</span> <span class="n">Document</span><span class="p">(</span><span class="n">html</span><span class="p">)</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
        <span class="n">desc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">readable</span><span class="p">))</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">desc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="k">print</span> <span class="nb">len</span><span class="p">(</span><span class="n">desc</span><span class="p">)</span>
    <span class="c1">#sleep(float(round(random.uniform(2.5, 5.2),1))) #sleep before next step.</span>
<span class="c1">#set scraped list to a column in our dataframe.</span>
<span class="n">scraper2</span><span class="p">[</span><span class="s1">&#39;desc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">desc</span>
<span class="c1">#unicode decoding attempt.</span>
<span class="n">desc_unicode</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">scraper2</span><span class="p">[</span><span class="s1">&#39;desc&#39;</span><span class="p">]:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="s1">&#39;replace&#39;</span><span class="p">)</span>
        <span class="n">desc_unicode</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">desc_unicode</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<span class="n">scraper2</span><span class="p">[</span><span class="s1">&#39;desc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">desc_unicode</span>
<span class="k">print</span> <span class="n">scraper2</span><span class="p">[</span><span class="s1">&#39;desc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="c1">#format all the column values to strings.</span>
<span class="n">scraper2</span><span class="p">[</span><span class="s1">&#39;desc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">job</span><span class="p">)</span> <span class="k">for</span> <span class="n">job</span> <span class="ow">in</span> <span class="n">scraper2</span><span class="p">[</span><span class="s1">&#39;desc&#39;</span><span class="p">]]</span>
<span class="c1">#strip out the html tags.</span>
<span class="n">scraper2</span><span class="p">[</span><span class="s1">&#39;desc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">striphtml</span><span class="p">(</span><span class="n">job</span><span class="p">)</span> <span class="k">for</span> <span class="n">job</span> <span class="ow">in</span> <span class="n">scraper2</span><span class="p">[</span><span class="s1">&#39;desc&#39;</span><span class="p">]]</span>
<span class="c1">#remove the formatting annotations.</span>
<span class="n">scraper2</span><span class="p">[</span><span class="s1">&#39;desc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\t\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">scraper2</span><span class="p">[</span><span class="s1">&#39;desc&#39;</span><span class="p">]]</span>
<span class="n">scraper2</span><span class="p">[</span><span class="s1">&#39;company&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">co</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\t\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">co</span> <span class="ow">in</span> <span class="n">scraper2</span><span class="p">[</span><span class="s1">&#39;company&#39;</span><span class="p">]]</span>
<span class="c1">#remove any this formatting errors that doesn&#39;t seem to go away.</span>
<span class="n">scraper2</span><span class="p">[</span><span class="s1">&#39;desc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&amp;#13;&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">scraper2</span><span class="p">[</span><span class="s1">&#39;desc&#39;</span><span class="p">]]</span>
<span class="c1">#check again for duplicates.</span>
<span class="k">print</span> <span class="s2">&quot;Shape before duplicates removed =&quot;</span><span class="p">,</span> <span class="n">scraper2</span><span class="o">.</span><span class="n">shape</span>
<span class="n">scraper2</span> <span class="o">=</span> <span class="n">scraper2</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">([</span><span class="s1">&#39;url&#39;</span><span class="p">])</span>
<span class="k">print</span> <span class="s2">&quot;Shape after duplicates removed =&quot;</span><span class="p">,</span><span class="n">scraper2</span><span class="o">.</span><span class="n">shape</span>
<span class="c1">#backup the scraped job descriptions to csv.</span>
<span class="n">scraper2</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;data/SCRAPED_JOB_DESCRIPTION_DATA_RAW.csv&#39;</span><span class="p">)</span>
</pre></div>


<h3>3: Scrape salary and benefits data for employer from Payscale.com</h3>
<div class="highlight"><pre><span></span><span class="c1">#Bring in the scraped csv from the above scraper.</span>
<span class="n">scraper2_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/SCRAPED_JOB_DESCRIPTION_DATA_RAW.csv&#39;</span><span class="p">)</span>
<span class="n">indeed</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scraper2_data</span><span class="p">)</span>
<span class="n">indeed</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;Unnamed: 0&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">print</span> <span class="n">indeed</span><span class="o">.</span><span class="n">shape</span>
<span class="n">indeed</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>(2132, 6)
</pre></div>


<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>title</th>
      <th>company</th>
      <th>url</th>
      <th>srange</th>
      <th>location</th>
      <th>desc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Forensic Scientist (Crime Scene)</td>
      <td>Dept of Forensic Sciences</td>
      <td>http://indeed.com/rc/clk?jk=70192ba18fa061a8&amp;f...</td>
      <td>['\n$61,491 - $79,275 a year\n\n\nAnd knowledg...</td>
      <td>Washington, DC</td>
      <td>Forensic Scientist (Crime Scene)CS-401-11Caree...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Data Scientist</td>
      <td>Excella Consulting</td>
      <td>http://indeed.com/rc/clk?jk=42cb30526e07b4ec&amp;f...</td>
      <td>['\n\n\nUsing machine learning and data mining...</td>
      <td>Washington, DC 20006 (Foggy Bottom area)</td>
      <td>Please Enable Cookies to ContinuePlease enabl...</td>
    </tr>
  </tbody>
</table>
</div>

<div class="highlight"><pre><span></span><span class="n">df_company</span> <span class="o">=</span> <span class="n">indeed</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;company&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="n">df_company</span> <span class="o">=</span> <span class="n">df_company</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="k">print</span> <span class="s1">&#39;Number of companies =&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_company</span><span class="p">[</span><span class="s1">&#39;company&#39;</span><span class="p">])</span>
<span class="n">df_company</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>


<div class="highlight"><pre><span></span>Number of companies = 946
</pre></div>


<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>company</th>
      <th>title</th>
      <th>url</th>
      <th>srange</th>
      <th>location</th>
      <th>desc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1010data</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2U</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3M</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ADP</td>
      <td>21</td>
      <td>21</td>
      <td>21</td>
      <td>21</td>
      <td>21</td>
    </tr>
    <tr>
      <th>4</th>
      <td>AECOM</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>

<p>Below is the code that was used to scrape company salary data from payscale.com.</p>
<div class="highlight"><pre><span></span><span class="c1">#Empty dataframe to hold our results.</span>
<span class="n">ds_salary</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df_company</span><span class="p">[</span><span class="s1">&#39;company&#39;</span><span class="p">]:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1">#open Chrome</span>
        <span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">chrome_options</span><span class="o">=</span><span class="n">chrome_options</span><span class="p">)</span>
        <span class="c1">#navigate to payscale.com</span>
        <span class="n">driver</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;http://www.payscale.com/research/US/Country=United_States/Salary&quot;</span><span class="p">)</span>
        <span class="c1">#find the dropdown nav</span>
        <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s2">&quot;.//a[@id=&#39;rcSearchDropDownBtn&#39;]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="c1">#find the employer option in the dropdown</span>
        <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s2">&quot;.//li[@title=&#39;Employers&#39;]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="c1">#find the search bar</span>
        <span class="n">elem</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_name</span><span class="p">(</span><span class="s1">&#39;str&#39;</span><span class="p">)</span>
        <span class="c1">#pass in the company name from the indeed post.</span>
        <span class="n">elem</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="c1">#wait two seconds.</span>
        <span class="n">sleep</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>
        <span class="c1">#click on the first result from the suggested search options.</span>
        <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s2">&quot;.//li[@class=&#39;ui-menu-item&#39;][1]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="c1">#click on the years of experience tab on that companies page.</span>
        <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_link_text</span><span class="p">(</span><span class="s1">&#39;By Years Experience&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="c1">#wait for the whole page to load.</span>
        <span class="n">sleep</span><span class="p">(</span><span class="mf">5.0</span><span class="p">)</span>
        <span class="c1">#soupify the page.</span>
        <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">driver</span><span class="o">.</span><span class="n">page_source</span><span class="p">,</span><span class="s1">&#39;html.parser&#39;</span><span class="p">,</span> <span class="n">from_encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
        <span class="c1">#find the first table with the salaries by years of experience.</span>
        <span class="n">table</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;table&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span><span class="s1">&#39;tlf f11 w600&#39;</span><span class="p">})[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1">#parse the table into a dataframe.</span>
        <span class="n">twodim_table</span> <span class="o">=</span> <span class="n">parse</span><span class="o">.</span><span class="n">make2d</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
        <span class="n">df_scrape_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">twodim_table</span><span class="p">)</span>
        <span class="c1">#drop the top and bottom rows in the dataframe to remove the header and footer from the html page.</span>
        <span class="n">df_scrape_test</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">df_scrape_test</span> <span class="o">=</span> <span class="n">df_scrape_test</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="c1">#remove the number of salaries data from the first column.</span>
        <span class="n">df_scrape_test</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_scrape_test</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
        <span class="c1">#return only the first two columns of the dataframe.</span>
        <span class="n">df_scrape_test</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">df_scrape_test</span> <span class="o">=</span> <span class="n">df_scrape_test</span><span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
        <span class="n">df_scrape_test</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">df_scrape_test</span> <span class="o">=</span> <span class="n">df_scrape_test</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="c1">#Add in the company name so that you can compare against the data from Indeed.</span>
        <span class="n">df_scrape_test</span><span class="p">[</span><span class="s1">&#39;salary_company_source&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;h1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">ds_salary</span> <span class="o">=</span> <span class="n">ds_salary</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_scrape_test</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">s2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;1-4 &#39;</span><span class="p">,</span> <span class="s1">&#39;5-9 &#39;</span><span class="p">,</span> <span class="s1">&#39;10-19 &#39;</span><span class="p">,</span> <span class="s1">&#39;20 &#39;</span><span class="p">,</span> <span class="s1">&#39;Less than 1 &#39;</span><span class="p">])</span>
        <span class="n">ds_salary</span> <span class="o">=</span> <span class="n">ds_salary</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">driver</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">print</span> <span class="s2">&quot;scraped </span><span class="si">%d</span><span class="s2"> out of </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ds_salary</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_company</span><span class="p">[</span><span class="s1">&#39;company&#39;</span><span class="p">]))</span>
<span class="c1">#since you&#39;re running this while you go to bed. Export it as a csv to check in the morning.</span>
<span class="n">ds_salary</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;data/PAYSCALE_SCRAPED_COMPANY_SALARY_DATA_RAW.csv&#39;</span><span class="p">)</span>
</pre></div>


<p>Below is the code that was used to scrape company benefits data.</p>
<div class="highlight"><pre><span></span><span class="n">ds_benefits</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df_company</span><span class="p">[</span><span class="s1">&#39;company&#39;</span><span class="p">]:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1">#open Chrome</span>
        <span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">chrome_options</span><span class="o">=</span><span class="n">chrome_options</span><span class="p">)</span>
        <span class="c1">#navigate to payscale.com</span>
        <span class="n">driver</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;http://www.payscale.com/research/US/Country=United_States/Salary&quot;</span><span class="p">)</span>
        <span class="c1">#find the dropdown nav</span>
        <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s2">&quot;.//a[@id=&#39;rcSearchDropDownBtn&#39;]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="c1">#find the employer option in the dropdown</span>
        <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s2">&quot;.//li[@title=&#39;Employers&#39;]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="c1">#find the search bar</span>
        <span class="n">elem</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_name</span><span class="p">(</span><span class="s1">&#39;str&#39;</span><span class="p">)</span>
        <span class="c1">#pass in the company name from the indeed post.</span>
        <span class="n">elem</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="c1">#wait two seconds.</span>
        <span class="n">sleep</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>
        <span class="c1">#click on the first result from the suggested search options.</span>
        <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s2">&quot;.//li[@class=&#39;ui-menu-item&#39;][1]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="c1">#soupify the page.</span>
        <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">driver</span><span class="o">.</span><span class="n">page_source</span><span class="p">,</span><span class="s1">&#39;html.parser&#39;</span><span class="p">,</span> <span class="n">from_encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
        <span class="c1">#find the first table with the salaries by years of experience.</span>
        <span class="n">table</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;table&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span><span class="s1">&#39;table table-condensed no-margin&#39;</span><span class="p">})[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1">#parse the table into a dataframe.</span>
        <span class="n">twodim_table</span> <span class="o">=</span> <span class="n">parse</span><span class="o">.</span><span class="n">make2d</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
        <span class="n">df_scrape_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">twodim_table</span><span class="p">)</span>
        <span class="c1">#drop the rows and columns we don&#39;t need</span>
        <span class="n">df_scrape_test</span> <span class="o">=</span> <span class="n">df_scrape_test</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span>
        <span class="n">df_scrape_test</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">17</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">df_scrape_test</span> <span class="o">=</span> <span class="n">df_scrape_test</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="n">df_scrape_test</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df_scrape_test</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">df_scrape_test</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">df_scrape_test</span><span class="p">[</span><span class="s1">&#39;benefits_company_source&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;h1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">ds_benefits</span> <span class="o">=</span> <span class="n">ds_benefits</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_scrape_test</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">s2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Job Satisfaction&#39;</span><span class="p">,</span> <span class="s1">&#39;Work Stress&#39;</span><span class="p">,</span> <span class="s1">&#39;Job Flexibility&#39;</span><span class="p">,</span> <span class="s1">&#39;Vacation Weeks&#39;</span><span class="p">])</span>
        <span class="n">ds_benefits</span> <span class="o">=</span> <span class="n">ds_benefits</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">driver</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">print</span> <span class="s2">&quot;scraped </span><span class="si">%d</span><span class="s2"> out of </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ds_benefits</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_company</span><span class="p">[</span><span class="s1">&#39;company&#39;</span><span class="p">]))</span>
<span class="c1">#since you&#39;re running this while you go to bed. Export it as a csv to check in the morning.</span>
<span class="n">ds_benefits</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;data/PAYSCALE_SCRAPED_BENEFITS_DATA_RAW.csv&#39;</span><span class="p">)</span>
</pre></div>


<p>Run the scraper tonight.</p>
<div class="highlight"><pre><span></span><span class="n">median_salary</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df_company</span><span class="p">[</span><span class="s1">&#39;company&#39;</span><span class="p">]:</span>
    <span class="k">try</span><span class="p">:</span>        
        <span class="c1">#open Chrome</span>
        <span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">chrome_options</span><span class="o">=</span><span class="n">chrome_options</span><span class="p">)</span>
        <span class="c1">#navigate to payscale.com</span>
        <span class="n">driver</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;http://www.payscale.com/research/US/Country=United_States/Salary&quot;</span><span class="p">)</span>
        <span class="c1">#find the dropdown nav</span>
        <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s2">&quot;.//a[@id=&#39;rcSearchDropDownBtn&#39;]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="c1">#find the employer option in the dropdown</span>
        <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s2">&quot;.//li[@title=&#39;Employers&#39;]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="c1">#find the search bar</span>
        <span class="n">elem</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_name</span><span class="p">(</span><span class="s1">&#39;str&#39;</span><span class="p">)</span>
        <span class="c1">#pass in the company name from the indeed post.</span>
        <span class="n">elem</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="c1">#wait two seconds.</span>
        <span class="n">sleep</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>
        <span class="c1">#click on the first result from the suggested search options.</span>
        <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s2">&quot;.//li[@class=&#39;ui-menu-item&#39;][1]&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="c1">#click on the by job tab on that companies page.</span>
        <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_link_text</span><span class="p">(</span><span class="s1">&#39;By Job&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>
        <span class="c1">#get the url for the jobs page.</span>
        <span class="n">url_source</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">current_url</span>
        <span class="c1">#adjust it to have the data_scientist job.</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">url_source</span><span class="p">[:</span><span class="o">-</span><span class="mi">6</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;Job/Data-Scientist&#39;</span>
        <span class="c1">#Go to that url you just retrieved.</span>
        <span class="n">driver</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="c1">#wait for the whole page to load.</span>
        <span class="n">sleep</span><span class="p">(</span><span class="mf">5.0</span><span class="p">)</span>
        <span class="c1">#soupify the page.</span>
        <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">driver</span><span class="o">.</span><span class="n">page_source</span><span class="p">,</span><span class="s1">&#39;html.parser&#39;</span><span class="p">,</span> <span class="n">from_encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
        <span class="c1">#empty list to hold median salary so we can clean up the data.</span>
        <span class="n">med_salary</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1">#get the median salary from the chart.</span>
        <span class="n">med_salary</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span><span class="s1">&#39;you_label&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
        <span class="c1">#encode it properly</span>
        <span class="c1">#med_salary = [job.encode(&#39;ascii&#39;,&#39;ignore&#39;) for job in med_salary]</span>
        <span class="c1">#clean/format the returned text.</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">med_salary</span><span class="p">:</span>    
            <span class="n">head</span><span class="p">,</span> <span class="n">sep</span><span class="p">,</span> <span class="n">tail</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">partition</span><span class="p">(</span><span class="s1">&#39;MEDIAN:&#39;</span><span class="p">)</span>
            <span class="n">tail</span> <span class="o">=</span> <span class="n">tail</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">tail</span> <span class="o">=</span> <span class="n">tail</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="c1">#append it to the running list.</span>
            <span class="n">median_salary</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tail</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">median_salary</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="k">print</span> <span class="n">median_salary</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">driver</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="c1">#Backup the scraper data to a csv.</span>
<span class="n">ds_salary</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;data/PAYSCALE_SCRAPED_DATASCIENCE_COMPANY_SALARY_DATA_RAW.csv&#39;</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#Bring in the scraped csv from the above scraper.</span>
<span class="n">scraper3_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/PAYSCALE_SCRAPED_COMPANY_SALARY_DATA_RAW.csv&#39;</span><span class="p">)</span>
<span class="n">payscale_scraped_a</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scraper3_data</span><span class="p">)</span>
<span class="n">payscale_scraped_a</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;Unnamed: 0&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">print</span> <span class="n">payscale_scraped_a</span><span class="o">.</span><span class="n">shape</span>
<span class="n">payscale_scraped_a</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>(946, 6)
</pre></div>


<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1-4</th>
      <th>10-19</th>
      <th>20</th>
      <th>5-9</th>
      <th>Less than 1</th>
      <th>salary_company_source</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<div class="highlight"><pre><span></span><span class="c1">#Bring in the scraped csv from the above scraper.</span>
<span class="n">scraper4_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/PAYSCALE_SCRAPED_BENEFITS_DATA_RAW.csv&#39;</span><span class="p">)</span>
<span class="n">payscale_scraped_b</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scraper4_data</span><span class="p">)</span>
<span class="n">payscale_scraped_b</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;Unnamed: 0&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">print</span> <span class="n">payscale_scraped_b</span><span class="o">.</span><span class="n">shape</span>
<span class="n">payscale_scraped_b</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>(946, 5)
</pre></div>


<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Job Flexibility</th>
      <th>Job Satisfaction</th>
      <th>Vacation Weeks</th>
      <th>Work Stress</th>
      <th>benefits_company_source</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<div class="highlight"><pre><span></span><span class="c1">#Concat the two scraped dataframes from Payscale.com</span>
<span class="n">df_payscale_scraped</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">payscale_scraped_a</span><span class="p">,</span> <span class="n">payscale_scraped_b</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="k">print</span> <span class="n">df_payscale_scraped</span><span class="o">.</span><span class="n">shape</span>
<span class="n">df_payscale_scraped</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>(946, 11)
</pre></div>


<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1-4</th>
      <th>10-19</th>
      <th>20</th>
      <th>5-9</th>
      <th>Less than 1</th>
      <th>salary_company_source</th>
      <th>Job Flexibility</th>
      <th>Job Satisfaction</th>
      <th>Vacation Weeks</th>
      <th>Work Stress</th>
      <th>benefits_company_source</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<div class="highlight"><pre><span></span><span class="c1">#Add in the two csv&#39;s we scraped above to the company dataframe for us to check and make sure we scraped</span>
<span class="c1">#the right companies when we did the search.</span>
<span class="c1">#First cleaning up the company source columns so we can better evaluate the search results.</span>
<span class="n">df_company_scraped</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_payscale_scraped</span><span class="p">,</span> <span class="n">df_company</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df_company_scraped</span><span class="p">[</span><span class="s1">&#39;salary_company_source&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_company_scraped</span><span class="p">[</span><span class="s1">&#39;salary_company_source&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;Average Salary for &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">df_company_scraped</span><span class="p">[</span><span class="s1">&#39;salary_company_source&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_company_scraped</span><span class="p">[</span><span class="s1">&#39;salary_company_source&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; Employees&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">df_company_scraped</span><span class="p">[</span><span class="s1">&#39;benefits_company_source&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_company_scraped</span><span class="p">[</span><span class="s1">&#39;benefits_company_source&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;Average Salary for &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">df_company_scraped</span><span class="p">[</span><span class="s1">&#39;benefits_company_source&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_company_scraped</span><span class="p">[</span><span class="s1">&#39;benefits_company_source&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; Employees&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">df_company_scraped</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>


<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1-4</th>
      <th>10-19</th>
      <th>20</th>
      <th>5-9</th>
      <th>Less than 1</th>
      <th>salary_company_source</th>
      <th>Job Flexibility</th>
      <th>Job Satisfaction</th>
      <th>Vacation Weeks</th>
      <th>Work Stress</th>
      <th>benefits_company_source</th>
      <th>company</th>
      <th>title</th>
      <th>url</th>
      <th>srange</th>
      <th>location</th>
      <th>desc</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1010data</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2U</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>$66,892</td>
      <td>$95,353</td>
      <td>$108,094</td>
      <td>$81,724</td>
      <td>$58,687</td>
      <td>3M Company</td>
      <td>Data Not Available</td>
      <td>Extremely satisfied</td>
      <td>2.7 Weeks</td>
      <td>Stressful</td>
      <td>3M Company</td>
      <td>3M</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>ADP</td>
      <td>21</td>
      <td>21</td>
      <td>21</td>
      <td>21</td>
      <td>21</td>
    </tr>
    <tr>
      <th>4</th>
      <td>$59,207</td>
      <td>$89,051</td>
      <td>$112,775</td>
      <td>$70,423</td>
      <td>$53,903</td>
      <td>Aecom Corporation</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>AECOM</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>

<div class="highlight"><pre><span></span><span class="c1">#Export it as a csv to check we got the right companies.</span>
<span class="n">df_company_scraped</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;data/PAYSCALE_SCRAPED_DATA_ALL_RAW.csv&#39;</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#Bring in the cleaned CSV for companies scraped to join to our original dataframe.</span>
<span class="n">payscale_clean</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/PAYSCALE_SCRAPED_DATA_ALL_CLEAN.csv&#39;</span><span class="p">)</span>
<span class="n">payscale</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">payscale_clean</span><span class="p">)</span>
<span class="n">payscale</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;Unnamed: 0&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c1">#Rename the column headers since excel screws them up.</span>
<span class="n">payscale</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;4-Jan&#39;</span><span class="p">:</span><span class="s1">&#39;1-4&#39;</span><span class="p">,</span> <span class="s1">&#39;19-Oct&#39;</span><span class="p">:</span><span class="s1">&#39;10-19&#39;</span><span class="p">,</span> <span class="s1">&#39;9-May&#39;</span><span class="p">:</span><span class="s1">&#39;5-9&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">print</span> <span class="n">payscale</span><span class="o">.</span><span class="n">shape</span>
<span class="n">payscale</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>(946, 10)
</pre></div>


<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>company</th>
      <th>1-4</th>
      <th>10-19</th>
      <th>20</th>
      <th>5-9</th>
      <th>Less than 1</th>
      <th>Job Flexibility</th>
      <th>Job Satisfaction</th>
      <th>Vacation Weeks</th>
      <th>Work Stress</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1010data</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>$91,233</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2U</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<div class="highlight"><pre><span></span><span class="c1">#Take the spaces at the begining of the company out so that you can have more accurate data.</span>
<span class="c1">#company_test[&#39;company&#39;] = [i.strip() for i in company_test[&#39;company&#39;]]</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#Merge the two dataframes joining on &#39;company&#39;. I know from running this before that the pay bracket of 1-4 was</span>
<span class="c1">#the most accurate for building an estimator for a data_scientists salary so I am going to only import that</span>
<span class="c1">#column here.</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">indeed</span><span class="p">,</span> <span class="n">payscale</span><span class="p">[[</span><span class="s1">&#39;company&#39;</span><span class="p">,</span> <span class="s1">&#39;1-4&#39;</span><span class="p">,</span> <span class="s1">&#39;Job Flexibility&#39;</span><span class="p">,</span> <span class="s1">&#39;Job Satisfaction&#39;</span><span class="p">,</span> <span class="s1">&#39;Vacation Weeks&#39;</span><span class="p">,</span> <span class="s1">&#39;Work Stress&#39;</span><span class="p">]],</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;company&#39;</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="k">print</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>


<div class="highlight"><pre><span></span>(2132, 11)
</pre></div>


<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>title</th>
      <th>company</th>
      <th>url</th>
      <th>srange</th>
      <th>location</th>
      <th>desc</th>
      <th>1-4</th>
      <th>Job Flexibility</th>
      <th>Job Satisfaction</th>
      <th>Vacation Weeks</th>
      <th>Work Stress</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Forensic Scientist (Crime Scene)</td>
      <td>Dept of Forensic Sciences</td>
      <td>http://indeed.com/rc/clk?jk=70192ba18fa061a8&amp;f...</td>
      <td>['\n$61,491 - $79,275 a year\n\n\nAnd knowledg...</td>
      <td>Washington, DC</td>
      <td>Forensic Scientist (Crime Scene)CS-401-11Caree...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Data Scientist</td>
      <td>Excella Consulting</td>
      <td>http://indeed.com/rc/clk?jk=42cb30526e07b4ec&amp;f...</td>
      <td>['\n\n\nUsing machine learning and data mining...</td>
      <td>Washington, DC 20006 (Foggy Bottom area)</td>
      <td>Please Enable Cookies to ContinuePlease enabl...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Data Scientist</td>
      <td>Booz Allen Hamilton</td>
      <td>http://indeed.com/rc/clk?jk=33f586dafa3deb4c&amp;f...</td>
      <td>['\n\n\nApply expertise in advanced analytics,...</td>
      <td>Washington, DC</td>
      <td>Booz Allen Hamilt...</td>
      <td>$64,587</td>
      <td>Extremely flexible</td>
      <td>Highly satisfied</td>
      <td>2.8 Weeks</td>
      <td>Stressful</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Data Scientist</td>
      <td>Vox Media</td>
      <td>http://indeed.com/rc/clk?jk=0a9009fd2170cf66&amp;f...</td>
      <td>['\n\n\nData Scientists are responsible for de...</td>
      <td>Washington, DC</td>
      <td>U.S. Equal Opportunity Employment Informatio...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Data Scientist/Engineer</td>
      <td>ICF International</td>
      <td>http://indeed.com/rc/clk?jk=d29754cbfaf00024&amp;f...</td>
      <td>['\n\n\nSpecifically, it provides psychologica...</td>
      <td>Silver Spring, MD</td>
      <td>Copyright 1992-2016 ICF International, Inc. Al...</td>
      <td>$55,720</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<h1>FILTERING</h1>
<p>We know that the median data scientist job salary in Wasington DC is 95,000. However when we scrape all the data scientist jobs posted by Indeed.com we get a median of 75,000. You can interprete that as there are not high paying data scientist jobs available or there are jobs that are not TRULY data scientist jobs being returned by the search. The assumption I chose was the latter because following that route would result in the cleanest data set possible to make a prediction. So below we are going to build a filter to see how many Data Scientist jobs are ACTUALLY being returned by the indeed.com search.</p>
<h3>5: Filter jobs to only ones that have "Data Scientist" in the title.</h3>
<div class="highlight"><pre><span></span><span class="c1">#def uppercase(x):</span>
    <span class="c1">#return(x.upper())</span>

<span class="c1">#map_dict = {</span>
    <span class="c1">#&#39;title&#39; : &#39;new_title&#39;</span>
<span class="c1">#}</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#df[&#39;new_title&#39;] = df[&#39;title&#39;].map(map_dict)</span>

<span class="c1">#df[&#39;title&#39;].apply(uppercase())</span>
<span class="c1">#Convert the title column to uppercase so we can search easily.</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">])</span>
<span class="c1">#Convert all the data here to strings to resolve a float error.</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;desc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;desc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
<span class="c1">#Convert the job descriptions to all uppercase words so that we are comparing apples to apples.</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;desc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;desc&#39;</span><span class="p">])</span>
<span class="c1">#create a desc length column that we will use later.</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;desc_len&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;desc&#39;</span><span class="p">]]</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">ds_in_title</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1">#Find the job titles that match the parameters below and put the results into a new column.</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="s1">&#39;DATA SCIENTIST&#39;</span> <span class="ow">in</span> <span class="n">i</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">ds_in_title</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ds_in_title</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<span class="c1">#Make a column with a 1 if its a match to the above search.</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;ds_in_title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds_in_title</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#Now filter this dataframe by only jobs that have data scientist in the title.</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ds_in_title&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">1.0</span><span class="p">]</span>
<span class="c1">#Filter out job descriptions that are below 800 characters so that we get the best data possible here.</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">df1</span><span class="p">[</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;desc_len&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">800</span><span class="p">]</span>
<span class="n">df1</span><span class="o">.</span><span class="n">shape</span>
</pre></div>


<div class="highlight"><pre><span></span>(277, 13)
</pre></div>


<h3>6: Get keywords from these posts by using TFIDF vectorizer.</h3>
<div class="highlight"><pre><span></span><span class="c1">#Declare the X target as the job descriptions for only jobs with Data Scientist in the title.</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df1</span><span class="p">[</span><span class="s1">&#39;desc&#39;</span><span class="p">]</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#Get the most important keywords across jobs that have data scientist in the title. We&#39;ll use these keywords</span>
<span class="c1">#to find other data science jobs that might not have data scientist in the title.</span>

<span class="c1">#You can pass a function into analyzer that can parse sentences into different parts of speech.</span>

<span class="c1">#Look into stemming for the words that are passed into the TFIDFvect, &quot;WALK vs. WALKS&quot;, tokenizer.</span>

<span class="n">tfidfv</span> <span class="o">=</span> <span class="n">TfidfVectorizer</span><span class="p">(</span><span class="n">analyzer</span><span class="o">=</span><span class="s1">&#39;word&#39;</span><span class="p">,</span> <span class="n">ngram_range</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">min_df</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">stop_words</span> <span class="o">=</span> <span class="s1">&#39;english&#39;</span><span class="p">,</span> <span class="n">max_features</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
<span class="n">vect_model</span> <span class="o">=</span> <span class="n">tfidfv</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">dense</span> <span class="o">=</span> <span class="n">vect_model</span><span class="o">.</span><span class="n">todense</span><span class="p">()</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#Below is the list of most important words and their tfidf scores for importance to all the jobs that had</span>
<span class="c1">#data scientist in the title. We&#39;ll use these keyword weights to then get a weighted score for whether or not</span>
<span class="c1">#a certain job description is likely to be a data scientist job or not.</span>
<span class="n">dense_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dense</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">tfidfv</span><span class="o">.</span><span class="n">get_feature_names</span><span class="p">()])</span>
<span class="n">dense_test</span> <span class="o">=</span> <span class="n">dense_test</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="n">dense_test</span><span class="p">[</span><span class="s1">&#39;mean_tfidf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dense_test</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">dense_test</span> <span class="o">=</span> <span class="n">dense_test</span><span class="p">[[</span><span class="s1">&#39;mean_tfidf&#39;</span><span class="p">]]</span>
<span class="n">dense_test</span> <span class="o">=</span> <span class="n">dense_test</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">dense_test</span> <span class="o">=</span> <span class="n">dense_test</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;mean_tfidf&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">dense_test</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
</pre></div>


<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>mean_tfidf</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1117</th>
      <td>data</td>
      <td>0.125944</td>
    </tr>
    <tr>
      <th>1782</th>
      <td>experience</td>
      <td>0.055743</td>
    </tr>
    <tr>
      <th>4921</th>
      <td>work</td>
      <td>0.031810</td>
    </tr>
    <tr>
      <th>311</th>
      <td>analytics</td>
      <td>0.031547</td>
    </tr>
    <tr>
      <th>273</th>
      <td>analysis</td>
      <td>0.031239</td>
    </tr>
    <tr>
      <th>622</th>
      <td>business</td>
      <td>0.029713</td>
    </tr>
    <tr>
      <th>3946</th>
      <td>science</td>
      <td>0.029436</td>
    </tr>
    <tr>
      <th>4503</th>
      <td>team</td>
      <td>0.027925</td>
    </tr>
    <tr>
      <th>2635</th>
      <td>learning</td>
      <td>0.027859</td>
    </tr>
    <tr>
      <th>4144</th>
      <td>skills</td>
      <td>0.027441</td>
    </tr>
    <tr>
      <th>3066</th>
      <td>new</td>
      <td>0.027022</td>
    </tr>
    <tr>
      <th>4310</th>
      <td>statistical</td>
      <td>0.026229</td>
    </tr>
    <tr>
      <th>2752</th>
      <td>machine</td>
      <td>0.024288</td>
    </tr>
    <tr>
      <th>3972</th>
      <td>scientist</td>
      <td>0.023858</td>
    </tr>
    <tr>
      <th>82</th>
      <td>ability</td>
      <td>0.023826</td>
    </tr>
    <tr>
      <th>2753</th>
      <td>machine learning</td>
      <td>0.023634</td>
    </tr>
    <tr>
      <th>4200</th>
      <td>solutions</td>
      <td>0.023620</td>
    </tr>
    <tr>
      <th>1166</th>
      <td>data scientist</td>
      <td>0.023415</td>
    </tr>
    <tr>
      <th>1164</th>
      <td>data science</td>
      <td>0.021775</td>
    </tr>
    <tr>
      <th>4740</th>
      <td>using</td>
      <td>0.021517</td>
    </tr>
  </tbody>
</table>
</div>

<h3>7: Using the TFIDF scores as weights analyze ALL job descriptions.</h3>
<div class="highlight"><pre><span></span><span class="c1">#We have 5,000 words in the TFIDF dataframe which is WAY more than we need. So lets filter that to be fewer</span>
<span class="c1">#keywords so its easier to track.</span>
<span class="n">ds_keywords</span> <span class="o">=</span> <span class="n">dense_test</span><span class="p">[</span><span class="n">dense_test</span><span class="p">[</span><span class="s1">&#39;mean_tfidf&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.018</span><span class="p">]</span>
<span class="n">ds_keywords</span><span class="o">.</span><span class="n">shape</span>
</pre></div>


<div class="highlight"><pre><span></span>(38, 2)
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#Now lets format this dataframe into something that we can use to search through all our job descriptions.</span>
<span class="n">ds_key_test</span> <span class="o">=</span> <span class="n">ds_keywords</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="n">ds_key_test</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">ds_key_test</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ds_key_test</span> <span class="o">=</span> <span class="n">ds_key_test</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">ds_key_test</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">ds_key_test</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">ds_key_test</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">None</span>
<span class="n">ds_key_test</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="n">ds_key_test</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">ds_key_test</span>
</pre></div>


<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DATA</th>
      <th>EXPERIENCE</th>
      <th>WORK</th>
      <th>ANALYTICS</th>
      <th>ANALYSIS</th>
      <th>BUSINESS</th>
      <th>SCIENCE</th>
      <th>TEAM</th>
      <th>LEARNING</th>
      <th>SKILLS</th>
      <th>...</th>
      <th>MODELS</th>
      <th>INCLUDING</th>
      <th>TECHNOLOGY</th>
      <th>JOB</th>
      <th>ALGORITHMS</th>
      <th>PROBLEMS</th>
      <th>STRONG</th>
      <th>LARGE</th>
      <th>KNOWLEDGE</th>
      <th>METHODS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0.125944</td>
      <td>0.0557435</td>
      <td>0.0318102</td>
      <td>0.0315467</td>
      <td>0.0312387</td>
      <td>0.0297132</td>
      <td>0.0294358</td>
      <td>0.0279249</td>
      <td>0.0278588</td>
      <td>0.0274412</td>
      <td>...</td>
      <td>0.0201235</td>
      <td>0.0199092</td>
      <td>0.0195241</td>
      <td>0.0194687</td>
      <td>0.01901</td>
      <td>0.0188275</td>
      <td>0.0187724</td>
      <td>0.0187513</td>
      <td>0.0182813</td>
      <td>0.0181009</td>
    </tr>
  </tbody>
</table>
<p>1 rows × 38 columns</p>
</div>

<div class="highlight"><pre><span></span><span class="c1">#Split up the strings of each job description so we can search through every word.</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;desc_test&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;desc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#All that work for this sweet little search engine filtering thingy.</span>
<span class="n">df_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">ds_key_test</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;desc_test&#39;</span><span class="p">]:</span>
    <span class="n">tl</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ds_key_test</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
                <span class="n">tl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ds_key_test</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">tl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">tl</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="n">append_test</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">ds_key_test</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span> <span class="n">tl</span><span class="p">))</span>
    <span class="n">df_test</span> <span class="o">=</span> <span class="n">df_test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">append_test</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>/Users/nathanhall/anaconda/lib/python2.7/site-packages/ipykernel/__main__.py:7: UnicodeWarning: Unicode equal comparison failed to convert both arguments to Unicode - interpreting them as being unequal
</pre></div>


<h3>8: Sum the TFIDF scores for each post and filter to the most "Data Sciency" jobs.</h3>
<div class="highlight"><pre><span></span><span class="c1">#Take the above resulting dataframe and sum up each job descprtion &quot;Data Sciency&quot; score.</span>
<span class="n">df_test</span><span class="p">[</span><span class="s1">&#39;likelihood&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_test</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df_test</span><span class="o">.</span><span class="n">shape</span>
</pre></div>


<div class="highlight"><pre><span></span>(2132, 39)
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#Repeat the keyword analysis on the resulting job titles.</span>
<span class="c1">#Declare the X target as the titles for the jobs that were returned from our data scientist filter.</span>
<span class="n">X2</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#Get the most important keywords for these titles. This will serve as a better measure of the titles</span>
<span class="c1">#than the VERY many types that are in that column already.</span>
<span class="n">tfidfv2</span> <span class="o">=</span> <span class="n">TfidfVectorizer</span><span class="p">(</span><span class="n">analyzer</span><span class="o">=</span><span class="s1">&#39;word&#39;</span><span class="p">,</span> <span class="n">ngram_range</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">min_df</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">stop_words</span> <span class="o">=</span> <span class="s1">&#39;english&#39;</span><span class="p">,</span> <span class="n">max_features</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
<span class="n">vect_model2</span> <span class="o">=</span> <span class="n">tfidfv2</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X2</span><span class="p">)</span>
<span class="n">dense2</span> <span class="o">=</span> <span class="n">vect_model2</span><span class="o">.</span><span class="n">todense</span><span class="p">()</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#Below is the list of most important words and their tfidf scores for importance to all the jobs that had</span>
<span class="c1">#data scientist in the title. We&#39;ll use these keyword weights to then get a weighted score for whether or not</span>
<span class="c1">#a certain job description is likely to be a data scientist job or not.</span>
<span class="n">dense_test2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dense2</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">tfidfv2</span><span class="o">.</span><span class="n">get_feature_names</span><span class="p">()])</span>
<span class="n">dense_test2</span> <span class="o">=</span> <span class="n">dense_test2</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="n">dense_test2</span><span class="p">[</span><span class="s1">&#39;mean_tfidf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dense_test2</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">dense_test2</span> <span class="o">=</span> <span class="n">dense_test2</span><span class="p">[[</span><span class="s1">&#39;mean_tfidf&#39;</span><span class="p">]]</span>
<span class="n">dense_test2</span> <span class="o">=</span> <span class="n">dense_test2</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">dense_test2</span> <span class="o">=</span> <span class="n">dense_test2</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;mean_tfidf&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">dense_test2</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
</pre></div>


<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>mean_tfidf</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3343</th>
      <td>scientist</td>
      <td>0.082106</td>
    </tr>
    <tr>
      <th>992</th>
      <td>data</td>
      <td>0.077585</td>
    </tr>
    <tr>
      <th>1035</th>
      <td>data scientist</td>
      <td>0.069339</td>
    </tr>
    <tr>
      <th>3119</th>
      <td>research</td>
      <td>0.049677</td>
    </tr>
    <tr>
      <th>160</th>
      <td>analyst</td>
      <td>0.049665</td>
    </tr>
    <tr>
      <th>3567</th>
      <td>senior</td>
      <td>0.034015</td>
    </tr>
    <tr>
      <th>3122</th>
      <td>research analyst</td>
      <td>0.033665</td>
    </tr>
    <tr>
      <th>1346</th>
      <td>engineer</td>
      <td>0.029786</td>
    </tr>
    <tr>
      <th>2297</th>
      <td>manager</td>
      <td>0.017995</td>
    </tr>
    <tr>
      <th>3171</th>
      <td>research scientist</td>
      <td>0.016047</td>
    </tr>
    <tr>
      <th>433</th>
      <td>associate</td>
      <td>0.015385</td>
    </tr>
    <tr>
      <th>3586</th>
      <td>senior data</td>
      <td>0.015095</td>
    </tr>
    <tr>
      <th>3809</th>
      <td>sr</td>
      <td>0.014920</td>
    </tr>
    <tr>
      <th>3722</th>
      <td>software</td>
      <td>0.014719</td>
    </tr>
    <tr>
      <th>3024</th>
      <td>quantitative</td>
      <td>0.012095</td>
    </tr>
  </tbody>
</table>
</div>

<div class="highlight"><pre><span></span><span class="c1">#We have 5,000 words in the TFIDF dataframe which is WAY more than we need. So lets filter that to be fewer</span>
<span class="c1">#keywords so its easier to track. We should be pretty strict on this since there shouldn&#39;t be that much</span>
<span class="c1">#variation.</span>
<span class="n">ds_keywords2</span> <span class="o">=</span> <span class="n">dense_test2</span><span class="p">[</span><span class="n">dense_test2</span><span class="p">[</span><span class="s1">&#39;mean_tfidf&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.018</span><span class="p">]</span>
<span class="n">ds_keywords2</span><span class="o">.</span><span class="n">shape</span>
</pre></div>


<div class="highlight"><pre><span></span>(8, 2)
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#Now lets format this dataframe into something that we can use to search through all our job titles.</span>
<span class="n">ds_key_test2</span> <span class="o">=</span> <span class="n">ds_keywords2</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="n">ds_key_test2</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">ds_key_test2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ds_key_test2</span> <span class="o">=</span> <span class="n">ds_key_test2</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">ds_key_test2</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">ds_key_test2</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">ds_key_test2</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">None</span>
<span class="n">ds_key_test2</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="n">ds_key_test2</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">ds_key_test2</span>
</pre></div>


<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SCIENTIST</th>
      <th>DATA</th>
      <th>DATA SCIENTIST</th>
      <th>RESEARCH</th>
      <th>ANALYST</th>
      <th>SENIOR</th>
      <th>RESEARCH ANALYST</th>
      <th>ENGINEER</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0.0821064</td>
      <td>0.0775845</td>
      <td>0.0693389</td>
      <td>0.049677</td>
      <td>0.0496651</td>
      <td>0.0340151</td>
      <td>0.0336652</td>
      <td>0.0297859</td>
    </tr>
  </tbody>
</table>
</div>

<div class="highlight"><pre><span></span><span class="c1">#Split up the strings of each job description so we can search through every word.</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;title_test&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#All that work for this sweet little search engine filtering thingy.</span>
<span class="n">df_test2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">ds_key_test2</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;title_test&#39;</span><span class="p">]:</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ds_key_test2</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
                <span class="n">t2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ds_key_test2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">t2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">t2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="n">append_test2</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">ds_key_test2</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span> <span class="n">t2</span><span class="p">))</span>
    <span class="n">df_test2</span> <span class="o">=</span> <span class="n">df_test2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">append_test2</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>/Users/nathanhall/anaconda/lib/python2.7/site-packages/ipykernel/__main__.py:7: UnicodeWarning: Unicode equal comparison failed to convert both arguments to Unicode - interpreting them as being unequal
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#Take the above resulting dataframe and sum up each job title &quot;Data Sciency&quot; score.</span>
<span class="n">df_test2</span><span class="p">[</span><span class="s1">&#39;likelihood&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_test2</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">df_test2</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">col</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_title&#39;</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df_test2</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">df_test</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">col</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_keyword&#39;</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df_test</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#Concapt the resulting dataframes together</span>
<span class="n">df_keywords</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_test</span><span class="p">,</span> <span class="n">df_test2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="k">print</span> <span class="n">df_keywords</span><span class="o">.</span><span class="n">shape</span>
</pre></div>


<div class="highlight"><pre><span></span>(2132, 48)
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#Concat that score to the original dataframe.</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">df_keywords</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1">#Create a new dataframe that now filters our results to the most &quot;Data Sciency&quot; jobs.</span>
<span class="k">print</span> <span class="s2">&quot;df Shape Before Filter =&quot;</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span>
<span class="c1">#This threshold should remain near the same to catch the most &quot;data sciencey&quot; jobs.</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;likelihood_keyword&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.52</span><span class="p">]</span>
<span class="k">print</span> <span class="s2">&quot;df Shape After Filter =&quot;</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span>
<span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;likelihood_keyword&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>df Shape Before Filter = (2132, 63)
df Shape After Filter = (472, 63)
</pre></div>


<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>title</th>
      <th>company</th>
      <th>url</th>
      <th>srange</th>
      <th>location</th>
      <th>desc</th>
      <th>1-4</th>
      <th>Job Flexibility</th>
      <th>Job Satisfaction</th>
      <th>Vacation Weeks</th>
      <th>...</th>
      <th>likelihood_keyword</th>
      <th>SCIENTIST_title</th>
      <th>DATA_title</th>
      <th>DATA SCIENTIST_title</th>
      <th>RESEARCH_title</th>
      <th>ANALYST_title</th>
      <th>SENIOR_title</th>
      <th>RESEARCH ANALYST_title</th>
      <th>ENGINEER_title</th>
      <th>likelihood_title</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1172</th>
      <td>STATISTICAL CONSULTANT</td>
      <td>Equifax</td>
      <td>http://indeed.com/rc/clk?jk=e3db711f65629c93&amp;f...</td>
      <td>['\n\n\nManipulate large data sets, integrate ...</td>
      <td>Alpharetta, GA</td>
      <td>STATISTICAL CONSULTANT   APPLY          JOB ...</td>
      <td>$60,404</td>
      <td>Data Not Available</td>
      <td>Extremely satisfied</td>
      <td>2.7 Weeks</td>
      <td>...</td>
      <td>0.904738</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2016</th>
      <td>BUSINESS ANALYTICS MANAGER</td>
      <td>Medidata Solutions</td>
      <td>http://indeed.com/rc/clk?jk=eb009ead7e4f2013&amp;f...</td>
      <td>['\n\n\nManage data science projects involving...</td>
      <td>New York, NY 10003 (Greenwich Village area)</td>
      <td>OUR IN...</td>
      <td>$52,118</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>0.835336</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>29</th>
      <td>DATA SCIENTIST</td>
      <td>Ukpeagvik Iñupiat Corporation/Bowhead Fami...</td>
      <td>http://indeed.com/rc/clk?jk=65885ab70c3dbd8c&amp;f...</td>
      <td>['\n\n\nCrashes, The selected candidate will w...</td>
      <td>Washington, DC</td>
      <td>TRACKING CODE DTNH22-16-1780-F   JOB CODE...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>0.835324</td>
      <td>0.082106</td>
      <td>0.077585</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.159691</td>
    </tr>
    <tr>
      <th>927</th>
      <td>DATA SCIENTIST ( MACHINE LEARNING)</td>
      <td>IHS Markit</td>
      <td>http://indeed.com/rc/clk?jk=493df6b925152ae3&amp;f...</td>
      <td>['\n\n\nMachine learning, data mining, quantit...</td>
      <td>Washington, DC</td>
      <td>ABOUT IHS MARKIT  IHS MARKIT HARNESSES DEEP SO...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>0.828642</td>
      <td>0.082106</td>
      <td>0.077585</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.159691</td>
    </tr>
    <tr>
      <th>1072</th>
      <td>DATA SCIENTIST</td>
      <td>Cotiviti</td>
      <td>http://indeed.com/rc/clk?jk=c95e60155151f4e2&amp;f...</td>
      <td>['\n\n\nThis is a pioneering data scientist wh...</td>
      <td>Atlanta, GA</td>
      <td>REQUISITION NUMBER 16-0948   TITLE DATA S...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>0.818920</td>
      <td>0.082106</td>
      <td>0.077585</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.159691</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 63 columns</p>
</div>

<h1>WEIGHTING</h1>
<h3>9: Extract salary data from job post text for ALL "Data Sciency" jobs.</h3>
<div class="highlight"><pre><span></span><span class="c1">#format the srange column so you can extract the salary data.</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;srange&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;srange&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;[&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;srange&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;srange&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;srange&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;srange&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">r&quot;</span><span class="se">\\</span><span class="s2">n&quot;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>

<span class="c1">#exctract salary data that matches the following formats.</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;srange1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;srange&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="s1">&#39;(.\d\d,\d\d\d - .\d\d,\d\d\d)&#39;</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;srange2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;srange&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="s1">&#39;(.\d\d,\d\d\d - .\d\d\d,\d\d\d)&#39;</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#partition the strings in srange1 and srange2</span>
<span class="n">low_range1</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">high_range1</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;srange1&#39;</span><span class="p">]:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">head1</span><span class="p">,</span> <span class="n">sep1</span><span class="p">,</span> <span class="n">tail1</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">partition</span><span class="p">(</span><span class="s1">&#39; - &#39;</span><span class="p">)</span>
        <span class="n">low_range1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">head1</span><span class="p">)</span>
        <span class="n">high_range1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tail1</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">low_range1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="n">high_range1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<span class="c1">#Append the data to the dataframe that was extracted from the srange1 column.</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;low_srange1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">low_range1</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;high_srange1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">high_range1</span>
<span class="c1">#drop the srange column.</span>
<span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;srange1&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c1">#repeat the above step for srange2</span>
<span class="n">low_range2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">high_range2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;srange2&#39;</span><span class="p">]:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">head2</span><span class="p">,</span> <span class="n">sep2</span><span class="p">,</span> <span class="n">tail2</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">partition</span><span class="p">(</span><span class="s1">&#39; - &#39;</span><span class="p">)</span>
        <span class="n">low_range2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">head2</span><span class="p">)</span>
        <span class="n">high_range2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tail2</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">low_range2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="n">high_range2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<span class="c1">#Append the data to the dataframe that was extracted from the srange1 column.</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;low_srange2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">low_range2</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;high_srange2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">high_range2</span>
<span class="c1">#drop the srange2 column.</span>
<span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;srange2&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c1">#drop the srange column since we now have the data we need from it.</span>
<span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;srange&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#exctract salary data that matches the format for a 6 figure job from each job description.</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;extract_test_high&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;desc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="s1">&#39;(\d\d\d,\d\d\d\.\d\d)&#39;</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c1">#extract salary data that matches the format for a 5 figure job.</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;extract_test&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;desc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="s1">&#39;(\d\d,\d\d\d\.\d\d)&#39;</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c1">#for comparison... extract the salary data that does not have decimal places but is five figures.</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;extract_test1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;desc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="s1">&#39;(\d\d,\d\d\d)&#39;</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#To accomplish this we need to reformat some columns.</span>
<span class="n">format_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;low_srange1&#39;</span><span class="p">,</span> <span class="s1">&#39;1-4&#39;</span><span class="p">,</span> <span class="s1">&#39;high_srange1&#39;</span><span class="p">,</span> <span class="s1">&#39;low_srange2&#39;</span><span class="p">,</span> <span class="s1">&#39;high_srange2&#39;</span><span class="p">,</span> <span class="s1">&#39;extract_test_high&#39;</span><span class="p">,</span> <span class="s1">&#39;extract_test&#39;</span><span class="p">,</span> <span class="s1">&#39;extract_test1&#39;</span><span class="p">]</span>
<span class="c1">#Format all dollar value rows so that they can be converted to floats.</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="n">format_cols</span><span class="p">]:</span>
    <span class="n">df</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
    <span class="c1">#A way to compline the two str.replace into one line.</span>
    <span class="n">df</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;[\$,]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;$&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#Account for error values that may have been extracted. All our salary estimates should be over the median starting</span>
<span class="c1">#salary of an employee AT LEAST!</span>
<span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">format_cols</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">45000.0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">format_cols</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">140000.0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</pre></div>


<h3>10: Calculate the percentage increase over the median salary at each company.</h3>
<div class="highlight"><pre><span></span><span class="c1">#We will also take the high and low range salary estimate from the post and average it together so that we&#39;re</span>
<span class="c1">#working with only one number.</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;post_estimate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;low_srange1&#39;</span><span class="p">,</span> <span class="s1">&#39;high_srange1&#39;</span><span class="p">,</span> <span class="s1">&#39;low_srange2&#39;</span><span class="p">,</span> <span class="s1">&#39;high_srange2&#39;</span><span class="p">,</span> <span class="s1">&#39;extract_test_high&#39;</span><span class="p">,</span> <span class="s1">&#39;extract_test&#39;</span><span class="p">,</span> <span class="s1">&#39;extract_test1&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1">#drop all those srange columns now.</span>
<span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;low_srange1&#39;</span><span class="p">,</span> <span class="s1">&#39;high_srange1&#39;</span><span class="p">,</span> <span class="s1">&#39;low_srange2&#39;</span><span class="p">,</span> <span class="s1">&#39;high_srange2&#39;</span><span class="p">,</span> <span class="s1">&#39;extract_test_high&#39;</span><span class="p">,</span> <span class="s1">&#39;extract_test&#39;</span><span class="p">,</span> <span class="s1">&#39;extract_test1&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;post_estimate&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>


<div class="highlight"><pre><span></span>50000.000000     8
74000.000000     4
75000.000000     3
90000.000000     3
112946.666667    2
100000.000000    2
45000.000000     1
80000.000000     1
96366.500000     1
62000.000000     1
125000.000000    1
94411.600000     1
140000.000000    1
58000.000000     1
76000.000000     1
93159.333333     1
67419.000000     1
62338.000000     1
100306.500000    1
Name: post_estimate, dtype: int64
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#Now we&#39;ll take the post_estimate and known data science salaries at that company and create an initial estimate.</span>
<span class="c1">#df[&#39;initial_estimate&#39;] = df[[&#39;post_estimate&#39;, &#39;data_scientist_salary&#39;]].mean(axis=1)</span>
<span class="c1">#Now we&#39;re going to make a dataframe of only the data we can make our first two estimates off of.</span>

<span class="c1">#What does thresh=1 do again?</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;post_estimate&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">thresh</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">lsuffix</span><span class="o">=</span><span class="s1">&#39;_left&#39;</span><span class="p">,</span> <span class="n">rsuffix</span><span class="o">=</span><span class="s1">&#39;_right&#39;</span><span class="p">)</span>
<span class="n">df2</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;post_estimate_left&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c1">#Filter the dataframe to only have values from the 1-4 column. This will return just the posts that have BOTH</span>
<span class="c1">#1-4 year company data and the job post specific salary data.</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="n">df2</span><span class="p">[</span><span class="s1">&#39;1-4&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
<span class="k">print</span> <span class="n">df2</span><span class="o">.</span><span class="n">shape</span>
</pre></div>


<div class="highlight"><pre><span></span>(10, 63)
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#Now we&#39;ll use these job postings to calculate a percentage increase over a standard job at each of these companies.</span>
<span class="n">df2</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s1">&#39;post_estimate_right&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">df2</span><span class="p">[</span><span class="s1">&#39;1-4&#39;</span><span class="p">])</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#Average percentage increase over just normal year data that a data scientist salary should be making.</span>
<span class="n">ds_generic_weight</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">ds_generic_weight</span>
</pre></div>


<div class="highlight"><pre><span></span>1.2451427181054453
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#now the same thing but for each company.</span>
<span class="n">df3</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;company&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">df3</span> <span class="o">=</span> <span class="n">df3</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">df4</span> <span class="o">=</span> <span class="n">df3</span><span class="p">[[</span><span class="s1">&#39;company&#39;</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">]]</span>
<span class="n">df4</span>
</pre></div>


<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>company</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>BAE Systems</td>
      <td>1.418797</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Centers for Disease Control and Preven...</td>
      <td>1.661176</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Central Intelligence Agency</td>
      <td>1.023344</td>
    </tr>
    <tr>
      <th>3</th>
      <td>FactSet Research Systems</td>
      <td>0.741228</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Mars</td>
      <td>1.127447</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Teva Pharmaceuticals</td>
      <td>0.828382</td>
    </tr>
    <tr>
      <th>6</th>
      <td>U.S. Department of Labor</td>
      <td>1.686012</td>
    </tr>
  </tbody>
</table>
</div>

<div class="highlight"><pre><span></span><span class="c1">#Make a dictionary mapping function for the above companies.</span>
<span class="n">weight_dict</span> <span class="o">=</span> <span class="n">df4</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;company&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span>
</pre></div>


<h1>ESTIMATING</h1>
<p>You'll notice that above if we only used jobs that had salaries we'd have 49 out of every 560. That is why I built a salary estimator. With the salary data that is available for these companies if I use a weighted measure to estimate the salary of a data scientist then I will be able to keep posts that either have a salary range posted, a median data scientist salary posted, OR a median salary for a 1-4 year employee posted.</p>
<h3>11: For jobs without a salary in the post use the Data Science salary weight to estimate a salary for each company.</h3>
<div class="highlight"><pre><span></span><span class="c1">#Add a column of company weights we calclated earlier to the dataframe.</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;co_weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;company&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">weight_dict</span><span class="p">)</span>
<span class="c1">#Fill all the unknown weights for companies with the average increase of 25%.</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;co_weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;co_weight&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">ds_generic_weight</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#Now calculate a weighted salary estimate for each of the &quot;Data Sciency&quot; jobs we have in our dataframe.</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;weighted_estimate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;co_weight&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;1-4&#39;</span><span class="p">]</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#Now for the FINAL estimate we will average together the data that we have available to us.</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;estimate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;post_estimate&#39;</span><span class="p">,</span> <span class="s1">&#39;weighted_estimate&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#Before we move on to modeling though we need to drop the jobs in our dataframe that did not end up with an estimate.</span>
<span class="k">print</span> <span class="s2">&quot;df shape before estimate =&quot;</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;estimate&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
<span class="k">print</span> <span class="s2">&quot;df shape after estimate =&quot;</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>


<div class="highlight"><pre><span></span>df shape before estimate = (472, 66)
df shape after estimate = (219, 66)
</pre></div>


<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>title</th>
      <th>company</th>
      <th>url</th>
      <th>location</th>
      <th>desc</th>
      <th>1-4</th>
      <th>Job Flexibility</th>
      <th>Job Satisfaction</th>
      <th>Vacation Weeks</th>
      <th>Work Stress</th>
      <th>...</th>
      <th>RESEARCH_title</th>
      <th>ANALYST_title</th>
      <th>SENIOR_title</th>
      <th>RESEARCH ANALYST_title</th>
      <th>ENGINEER_title</th>
      <th>likelihood_title</th>
      <th>post_estimate</th>
      <th>co_weight</th>
      <th>weighted_estimate</th>
      <th>estimate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1172</th>
      <td>STATISTICAL CONSULTANT</td>
      <td>Equifax</td>
      <td>http://indeed.com/rc/clk?jk=e3db711f65629c93&amp;f...</td>
      <td>Alpharetta, GA</td>
      <td>STATISTICAL CONSULTANT   APPLY          JOB ...</td>
      <td>60404.0</td>
      <td>Data Not Available</td>
      <td>Extremely satisfied</td>
      <td>2.7 Weeks</td>
      <td>Stressful</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>1.245143</td>
      <td>75211.600744</td>
      <td>75211.600744</td>
    </tr>
    <tr>
      <th>2016</th>
      <td>BUSINESS ANALYTICS MANAGER</td>
      <td>Medidata Solutions</td>
      <td>http://indeed.com/rc/clk?jk=eb009ead7e4f2013&amp;f...</td>
      <td>New York, NY 10003 (Greenwich Village area)</td>
      <td>OUR IN...</td>
      <td>52118.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>1.245143</td>
      <td>64894.348182</td>
      <td>64894.348182</td>
    </tr>
    <tr>
      <th>927</th>
      <td>DATA SCIENTIST ( MACHINE LEARNING)</td>
      <td>IHS Markit</td>
      <td>http://indeed.com/rc/clk?jk=493df6b925152ae3&amp;f...</td>
      <td>Washington, DC</td>
      <td>ABOUT IHS MARKIT  IHS MARKIT HARNESSES DEEP SO...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.159691</td>
      <td>50000.0</td>
      <td>1.245143</td>
      <td>NaN</td>
      <td>50000.000000</td>
    </tr>
    <tr>
      <th>1496</th>
      <td>CHIEF DATA SCIENTIST</td>
      <td>S&amp;P GLOBAL</td>
      <td>http://indeed.com/rc/clk?jk=307ac18e77a35c8a&amp;f...</td>
      <td>New York, NY 10002 (Lower East Side area)</td>
      <td>POSITION DESCRIPTION  ...</td>
      <td>67348.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.159691</td>
      <td>NaN</td>
      <td>1.245143</td>
      <td>83857.871779</td>
      <td>83857.871779</td>
    </tr>
    <tr>
      <th>1355</th>
      <td>PRINCIPAL DATA SCIENTIST</td>
      <td>Aetna</td>
      <td>http://indeed.com/rc/clk?jk=6a7a681f17bfde42&amp;f...</td>
      <td>New York, NY 10016 (Gramercy area)</td>
      <td>POSITION SUMMARY THE PRINCIPAL SCIENTIST PROVI...</td>
      <td>55214.0</td>
      <td>Data Not Available</td>
      <td>Extremely satisfied</td>
      <td>3.0 Weeks</td>
      <td>Highly stressful</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.159691</td>
      <td>NaN</td>
      <td>1.245143</td>
      <td>68749.310037</td>
      <td>68749.310037</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 66 columns</p>
</div>

<div class="highlight"><pre><span></span><span class="c1">#Predict against the estimate.</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">df_regressor</span> <span class="o">=</span> <span class="n">df</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">target2</span> <span class="o">=</span> <span class="n">df_regressor</span><span class="p">[</span><span class="s1">&#39;estimate&#39;</span><span class="p">]</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">df_regressor</span><span class="o">.</span><span class="n">columns</span>
</pre></div>


<div class="highlight"><pre><span></span>Index([u&#39;title&#39;, u&#39;company&#39;, u&#39;url&#39;, u&#39;location&#39;, u&#39;desc&#39;, u&#39;1-4&#39;,
       u&#39;Job Flexibility&#39;, u&#39;Job Satisfaction&#39;, u&#39;Vacation Weeks&#39;,
       u&#39;Work Stress&#39;, u&#39;desc_len&#39;, u&#39;ds_in_title&#39;, u&#39;desc_test&#39;,
       u&#39;title_test&#39;, u&#39;DATA_keyword&#39;, u&#39;EXPERIENCE_keyword&#39;, u&#39;WORK_keyword&#39;,
       u&#39;ANALYTICS_keyword&#39;, u&#39;ANALYSIS_keyword&#39;, u&#39;BUSINESS_keyword&#39;,
       u&#39;SCIENCE_keyword&#39;, u&#39;TEAM_keyword&#39;, u&#39;LEARNING_keyword&#39;,
       u&#39;SKILLS_keyword&#39;, u&#39;NEW_keyword&#39;, u&#39;STATISTICAL_keyword&#39;,
       u&#39;MACHINE_keyword&#39;, u&#39;SCIENTIST_keyword&#39;, u&#39;ABILITY_keyword&#39;,
       u&#39;MACHINE LEARNING_keyword&#39;, u&#39;SOLUTIONS_keyword&#39;,
       u&#39;DATA SCIENTIST_keyword&#39;, u&#39;DATA SCIENCE_keyword&#39;, u&#39;USING_keyword&#39;,
       u&#39;RESEARCH_keyword&#39;, u&#39;YEARS_keyword&#39;, u&#39;TOOLS_keyword&#39;,
       u&#39;INFORMATION_keyword&#39;, u&#39;DEVELOPMENT_keyword&#39;, u&#39;TECHNICAL_keyword&#39;,
       u&#39;COMPANY_keyword&#39;, u&#39;WORKING_keyword&#39;, u&#39;MODELS_keyword&#39;,
       u&#39;INCLUDING_keyword&#39;, u&#39;TECHNOLOGY_keyword&#39;, u&#39;JOB_keyword&#39;,
       u&#39;ALGORITHMS_keyword&#39;, u&#39;PROBLEMS_keyword&#39;, u&#39;STRONG_keyword&#39;,
       u&#39;LARGE_keyword&#39;, u&#39;KNOWLEDGE_keyword&#39;, u&#39;METHODS_keyword&#39;,
       u&#39;likelihood_keyword&#39;, u&#39;SCIENTIST_title&#39;, u&#39;DATA_title&#39;,
       u&#39;DATA SCIENTIST_title&#39;, u&#39;RESEARCH_title&#39;, u&#39;ANALYST_title&#39;,
       u&#39;SENIOR_title&#39;, u&#39;RESEARCH ANALYST_title&#39;, u&#39;ENGINEER_title&#39;,
       u&#39;likelihood_title&#39;, u&#39;post_estimate&#39;, u&#39;co_weight&#39;,
       u&#39;weighted_estimate&#39;, u&#39;estimate&#39;],
      dtype=&#39;object&#39;)
</pre></div>


<div class="highlight"><pre><span></span><span class="n">df_regressor</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;1-4&#39;</span><span class="p">,</span> <span class="s1">&#39;post_estimate&#39;</span><span class="p">,</span><span class="s1">&#39;weighted_estimate&#39;</span><span class="p">,</span> <span class="s1">&#39;estimate&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span> <span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">## ALTERNATIVE ESTIMATING</span>
<span class="n">le</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">X2</span> <span class="o">=</span> <span class="n">df_regressor</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">LabelEncoder</span><span class="p">()</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">)</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">le</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">target2</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="o">/</span><span class="nv">Users</span><span class="o">/</span><span class="s s-Atom">nathanhall</span><span class="o">/</span><span class="s s-Atom">anaconda</span><span class="o">/</span><span class="s s-Atom">lib</span><span class="o">/</span><span class="s s-Atom">python2</span><span class="mf">.7</span><span class="o">/</span><span class="s s-Atom">site</span><span class="o">-</span><span class="s s-Atom">packages</span><span class="o">/</span><span class="s s-Atom">numpy</span><span class="o">/</span><span class="s s-Atom">lib</span><span class="o">/</span><span class="s s-Atom">arraysetops</span><span class="p">.</span><span class="nn">py</span><span class="p">:</span><span class="mi">200</span><span class="s s-Atom">:</span> <span class="nv">FutureWarning</span><span class="s s-Atom">:</span> <span class="s s-Atom">numpy</span> <span class="s s-Atom">not_equal</span> <span class="s s-Atom">will</span> <span class="o">not</span> <span class="s s-Atom">check</span> <span class="s s-Atom">object</span> <span class="s s-Atom">identity</span> <span class="s s-Atom">in</span> <span class="s s-Atom">the</span> <span class="s s-Atom">future</span><span class="p">.</span> <span class="nv">The</span> <span class="s s-Atom">comparison</span> <span class="s s-Atom">did</span> <span class="o">not</span> <span class="s s-Atom">return</span> <span class="s s-Atom">the</span> <span class="s s-Atom">same</span> <span class="s s-Atom">result</span> <span class="s s-Atom">as</span> <span class="s s-Atom">suggested</span> <span class="s s-Atom">by</span> <span class="s s-Atom">the</span> <span class="nf">identity</span> <span class="p">(</span><span class="err">`</span><span class="o">is</span><span class="err">`</span><span class="p">))</span> <span class="s s-Atom">and</span> <span class="s s-Atom">will</span> <span class="s s-Atom">change</span><span class="p">.</span>
  <span class="s s-Atom">flag</span> <span class="o">=</span> <span class="s s-Atom">np</span><span class="p">.</span><span class="nf">concatenate</span><span class="p">(([</span><span class="nv">True</span><span class="p">],</span> <span class="s s-Atom">aux</span><span class="p">[</span><span class="mi">1</span><span class="s s-Atom">:</span><span class="p">]</span> <span class="p">!</span><span class="o">=</span> <span class="s s-Atom">aux</span><span class="p">[:-</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#Get a train and teset dataset for the above variables to put into random forest.</span>
<span class="n">X2_train</span><span class="p">,</span> <span class="n">X2_test</span><span class="p">,</span> <span class="n">y2_train</span><span class="p">,</span> <span class="n">y2_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=.</span><span class="mi">33</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">99</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#Run Random Forest on the data.</span>
<span class="n">rf2</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">()</span>
<span class="n">rf2_model</span> <span class="o">=</span> <span class="n">rf2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X2_train</span><span class="p">,</span> <span class="n">y2_train</span><span class="p">)</span>
<span class="n">y2_pred</span> <span class="o">=</span> <span class="n">rf2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X2_test</span><span class="p">)</span>

<span class="k">print</span> <span class="s2">&quot;RandomForest Cross_Val Score:</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">rf2</span><span class="p">,</span> <span class="n">X2_train</span><span class="p">,</span> <span class="n">y2_train</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="k">print</span> <span class="s2">&quot;Train/Test RandomForest Score:</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">rf2</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X2_test</span><span class="p">,</span> <span class="n">y2_test</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>RandomForest Cross_Val Score:   0.179160728784
Train/Test RandomForest Score:  -0.205902706264
</pre></div>


<div class="highlight"><pre><span></span><span class="n">X2_test</span><span class="o">.</span><span class="n">shape</span>
</pre></div>


<div class="highlight"><pre><span></span>(73, 62)
</pre></div>


<div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">y2_pred</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>73
</pre></div>


<div class="highlight"><pre><span></span><span class="n">X2_test</span><span class="p">[</span><span class="s1">&#39;estimate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y2_test</span>
<span class="n">X2_test</span><span class="p">[</span><span class="s1">&#39;predicted&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y2_pred</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">nathanhall</span><span class="o">/</span><span class="n">anaconda</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python2</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">ipykernel</span><span class="o">/</span><span class="n">__main__</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span> <span class="n">SettingWithCopyWarning</span><span class="p">:</span>
<span class="n">A</span> <span class="n">value</span> <span class="ow">is</span> <span class="n">trying</span> <span class="n">to</span> <span class="n">be</span> <span class="nb">set</span> <span class="n">on</span> <span class="n">a</span> <span class="n">copy</span> <span class="n">of</span> <span class="n">a</span> <span class="nb">slice</span> <span class="kn">from</span> <span class="nn">a</span> <span class="nn">DataFrame.</span>
<span class="n">Try</span> <span class="n">using</span> <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">row_indexer</span><span class="p">,</span><span class="n">col_indexer</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span> <span class="n">instead</span>

<span class="n">See</span> <span class="n">the</span> <span class="n">caveats</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">documentation</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">pandas</span><span class="o">.</span><span class="n">pydata</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">pandas</span><span class="o">-</span><span class="n">docs</span><span class="o">/</span><span class="n">stable</span><span class="o">/</span><span class="n">indexing</span><span class="o">.</span><span class="n">html</span><span class="c1">#indexing-view-versus-copy</span>
  <span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">nathanhall</span><span class="o">/</span><span class="n">anaconda</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python2</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">ipykernel</span><span class="o">/</span><span class="n">__main__</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span> <span class="n">SettingWithCopyWarning</span><span class="p">:</span>
<span class="n">A</span> <span class="n">value</span> <span class="ow">is</span> <span class="n">trying</span> <span class="n">to</span> <span class="n">be</span> <span class="nb">set</span> <span class="n">on</span> <span class="n">a</span> <span class="n">copy</span> <span class="n">of</span> <span class="n">a</span> <span class="nb">slice</span> <span class="kn">from</span> <span class="nn">a</span> <span class="nn">DataFrame.</span>
<span class="n">Try</span> <span class="n">using</span> <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">row_indexer</span><span class="p">,</span><span class="n">col_indexer</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span> <span class="n">instead</span>

<span class="n">See</span> <span class="n">the</span> <span class="n">caveats</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">documentation</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">pandas</span><span class="o">.</span><span class="n">pydata</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">pandas</span><span class="o">-</span><span class="n">docs</span><span class="o">/</span><span class="n">stable</span><span class="o">/</span><span class="n">indexing</span><span class="o">.</span><span class="n">html</span><span class="c1">#indexing-view-versus-copy</span>
  <span class="kn">from</span> <span class="nn">ipykernel</span> <span class="kn">import</span> <span class="n">kernelapp</span> <span class="k">as</span> <span class="n">app</span>
</pre></div>


<h1>MODELING</h1>
<h3>12a. Format dataframe features into dummy variables.</h3>
<div class="highlight"><pre><span></span><span class="n">df_keywords</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;likelihood_keyword&#39;</span><span class="p">,</span> <span class="s1">&#39;likelihood_title&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#Get the keywords for each job post as a dummy variable.</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">df_keywords</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">i_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="n">x</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">i_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">i_list</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">model_dummies</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;ds_in_title&#39;</span><span class="p">,</span> <span class="s1">&#39;Job Flexibility&#39;</span><span class="p">,</span> <span class="s1">&#39;Job Satisfaction&#39;</span><span class="p">,</span> <span class="s1">&#39;Work Stress&#39;</span><span class="p">]],</span> <span class="n">drop_first</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#Lets make a dataframe with all the things we think might be interesting to pass into a random forest model.</span>
<span class="n">df_model</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">model_dummies</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#Label each job post as being above or below the median to create our target.</span>
<span class="n">target</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="k">if</span> <span class="n">x</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">df_model</span><span class="p">[</span><span class="s1">&#39;estimate&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">85000</span><span class="p">]</span>
<span class="c1">#Dropping estimate from the model since that would be giving too much information to the random forest model.</span>
<span class="n">df_model</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;estimate&#39;</span><span class="p">,</span> <span class="s1">&#39;1-4&#39;</span><span class="p">,</span> <span class="s1">&#39;post_estimate&#39;</span><span class="p">,</span> <span class="s1">&#39;co_weight&#39;</span><span class="p">,</span> <span class="s1">&#39;weighted_estimate&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;company&#39;</span><span class="p">,</span> <span class="s1">&#39;url&#39;</span><span class="p">,</span> <span class="s1">&#39;location&#39;</span><span class="p">,</span> <span class="s1">&#39;desc&#39;</span><span class="p">,</span> <span class="s1">&#39;desc_test&#39;</span><span class="p">,</span><span class="s1">&#39;title_test&#39;</span><span class="p">,</span> <span class="s1">&#39;Job Flexibility&#39;</span><span class="p">,</span> <span class="s1">&#39;Job Satisfaction&#39;</span><span class="p">,</span> <span class="s1">&#39;ds_in_title&#39;</span><span class="p">,</span> <span class="s1">&#39;Work Stress&#39;</span><span class="p">,</span> <span class="s1">&#39;Vacation Weeks&#39;</span><span class="p">,</span> <span class="s1">&#39;COMPANY&#39;</span><span class="p">,</span> <span class="s1">&#39;WORK&#39;</span><span class="p">,</span> <span class="s1">&#39;NEW&#39;</span><span class="p">,</span> <span class="s1">&#39;SKILLS&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">print</span> <span class="s2">&quot;Shape of the model dataframe =&quot;</span><span class="p">,</span><span class="n">df_model</span><span class="o">.</span><span class="n">shape</span>
</pre></div>


<div class="highlight"><pre><span></span>Shape of the model dataframe = (219, 56)
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#Make a dataset for logistic regression.</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">log_model</span> <span class="o">=</span> <span class="n">df_model</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">log_model</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">target</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">log_model</span> <span class="o">=</span> <span class="n">log_model</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">log_model</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>


<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>desc_len</th>
      <th>DATA_keyword</th>
      <th>EXPERIENCE_keyword</th>
      <th>WORK_keyword</th>
      <th>ANALYTICS_keyword</th>
      <th>ANALYSIS_keyword</th>
      <th>BUSINESS_keyword</th>
      <th>SCIENCE_keyword</th>
      <th>TEAM_keyword</th>
      <th>LEARNING_keyword</th>
      <th>...</th>
      <th>ENGINEER_title</th>
      <th>likelihood_title</th>
      <th>Job Flexibility_Extremely flexible</th>
      <th>Job Flexibility_Highly flexible</th>
      <th>Job Satisfaction_Highly satisfied</th>
      <th>Job Satisfaction_Satisfied</th>
      <th>Work Stress_Highly stressful</th>
      <th>Work Stress_Somewhat stressful</th>
      <th>Work Stress_Stressful</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1172</th>
      <td>4637</td>
      <td>1</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2016</th>
      <td>6052</td>
      <td>1</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>927</th>
      <td>7079</td>
      <td>1</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.159691</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1496</th>
      <td>6500</td>
      <td>1</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.159691</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1355</th>
      <td>4835</td>
      <td>1</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.159691</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 57 columns</p>
</div>

<div class="highlight"><pre><span></span><span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">log_model1</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">log_model1</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">log_model1</span> <span class="o">=</span> <span class="n">log_model</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="s1">&#39;desc_len&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">X1</span> <span class="o">=</span> <span class="n">log_model1</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">log_model</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#Get a train and teset dataset for the above variables to put into random forest.</span>
<span class="n">X1_train</span><span class="p">,</span> <span class="n">X1_test</span><span class="p">,</span> <span class="n">y1_train</span><span class="p">,</span> <span class="n">y1_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=.</span><span class="mi">33</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">99</span><span class="p">)</span>
</pre></div>


<h3>12: Run all of our features through a Random Forest model to find what most influences a job being above or below the median salary.</h3>
<div class="highlight"><pre><span></span><span class="n">df_model</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">le</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df_model</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">LabelEncoder</span><span class="p">()</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">le</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#Get a train and teset dataset for the above variables to put into random forest.</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=.</span><span class="mi">33</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">99</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#Grid_search on the data above to find the best parameters to pass to Random Forest</span>
<span class="n">rf_grid</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">99</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>

<span class="c1">#Parameter dictionary of settings options for the model we&#39;re passing grid search.</span>
<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;criterion&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;gini&#39;</span><span class="p">,</span> <span class="s1">&#39;entropy&#39;</span><span class="p">],</span>
    <span class="s1">&#39;max_depth&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="bp">None</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span>
    <span class="s1">&#39;max_features&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="s1">&#39;sqrt&#39;</span><span class="p">,</span> <span class="s1">&#39;log2&#39;</span><span class="p">],</span>
    <span class="s1">&#39;class_weight&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;balanced&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">]</span>
<span class="p">}</span>

<span class="c1">#Instantiate grid search.</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">rf_grid</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">)</span>

<span class="c1">#Fit the grid search to X, and y.</span>
<span class="n">grid</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1">#Store the best parameters in a variable.</span>
<span class="n">params</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">best_params_</span>
<span class="k">print</span> <span class="s2">&quot;Best score =&quot;</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">best_score_</span>
<span class="k">print</span> <span class="n">params</span>
</pre></div>


<div class="highlight"><pre><span></span>Best score = 0.684931506849
{&#39;max_features&#39;: &#39;log2&#39;, &#39;criterion&#39;: &#39;entropy&#39;, &#39;max_depth&#39;: None, &#39;class_weight&#39;: &#39;balanced&#39;}
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#Run Random Forest on the data.</span>
<span class="n">rf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
<span class="n">rf_model</span> <span class="o">=</span> <span class="n">rf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">rf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="k">print</span> <span class="s2">&quot;RandomForest Cross_Val Score:</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">rf</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="k">print</span> <span class="s2">&quot;Train/Test RandomForest Score:</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">rf</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>RandomForest Cross_Val Score:   0.684827586207
Train/Test RandomForest Score:  0.58904109589
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#CONFUSION MATRIX FOR LOGISTIC REGRESSION</span>
<span class="n">confusion</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>

<span class="c1"># calculate true positives, the number of 1s correctly predicted to be 1</span>
<span class="k">print</span> <span class="s2">&quot;TP =&quot;</span><span class="p">,</span> <span class="n">confusion</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># calculate false positives, the number of 0s incorrectly predicted to be 1</span>
<span class="k">print</span> <span class="s2">&quot;FP =&quot;</span><span class="p">,</span> <span class="n">confusion</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># calculate true negatives, the number of 0s correctly predicted to be 0</span>
<span class="k">print</span> <span class="s2">&quot;TN =&quot;</span><span class="p">,</span> <span class="n">confusion</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="c1"># calculate false negatives, the number of 1s incorrectly predicted to be 0</span>
<span class="k">print</span> <span class="s2">&quot;FN =&quot;</span><span class="p">,</span> <span class="n">confusion</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="c1"># print out the classification report as well.</span>
<span class="k">print</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>TP = 36
FP = 20
TN = 7
FN = 10
             precision    recall  f1-score   support

          0       0.64      0.78      0.71        46
          1       0.41      0.26      0.32        27

avg / total       0.56      0.59      0.56        73
</pre></div>


<div class="highlight"><pre><span></span><span class="n">df_features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Features&#39;</span><span class="p">,</span> <span class="s1">&#39;Importance (Gini Index)&#39;</span><span class="p">])</span>
<span class="n">df_features</span><span class="p">[</span><span class="s1">&#39;Features&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_model</span><span class="o">.</span><span class="n">columns</span>
<span class="n">df_features</span><span class="p">[</span><span class="s1">&#39;Importance (Gini Index)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rf</span><span class="o">.</span><span class="n">feature_importances_</span>
<span class="n">df_features</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Importance (Gini Index)&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#Grid_search on the data above to find the best parameters to pass to Logistic Regression</span>
<span class="n">log_grid</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">LogisticRegressionCV</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">99</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;newton-cg&#39;</span><span class="p">,</span> <span class="n">penalty</span><span class="o">=</span><span class="s1">&#39;l2&#39;</span><span class="p">)</span>

<span class="c1">#Parameter dictionary of settings options for the model we&#39;re passing grid search.</span>
<span class="n">param_grid1</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Cs&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">9</span><span class="p">],</span>
    <span class="s1">&#39;cv&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span>
    <span class="s1">&#39;scoring&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="s1">&#39;r2&#39;</span><span class="p">],</span>
    <span class="s1">&#39;multi_class&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;ovr&#39;</span><span class="p">,</span> <span class="s1">&#39;multinomial&#39;</span><span class="p">]</span>
<span class="p">}</span>
<span class="c1">#Scoring to try = roc_auc, f1, precision, and accuracy</span>

<span class="c1">#Instantiate grid search.</span>
<span class="n">grid1</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">log_grid</span><span class="p">,</span> <span class="n">param_grid1</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">)</span>

<span class="c1">#Fit the grid search to X, and y.</span>
<span class="n">grid1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X1_train</span><span class="p">,</span> <span class="n">y1_train</span><span class="p">)</span>

<span class="c1">#Store the best parameters in a variable.</span>
<span class="n">params1</span> <span class="o">=</span> <span class="n">grid1</span><span class="o">.</span><span class="n">best_params_</span>
<span class="k">print</span> <span class="s2">&quot;Best score =&quot;</span><span class="p">,</span> <span class="n">grid1</span><span class="o">.</span><span class="n">best_score_</span>
<span class="k">print</span> <span class="n">params1</span>
</pre></div>


<div class="highlight"><pre><span></span>Best score = 0.602739726027
{&#39;Cs&#39;: 5, &#39;multi_class&#39;: &#39;ovr&#39;, &#39;cv&#39;: 5, &#39;scoring&#39;: &#39;accuracy&#39;}
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#def logistic_vs_svm(X_train, X_test, y_train, y_test):</span>
<span class="c1"># Looking at logistic regression compared to our target to see what a baseline accuracy would be.</span>
<span class="n">logistic</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">LogisticRegressionCV</span><span class="p">(</span><span class="o">**</span><span class="n">params1</span><span class="p">)</span>
<span class="n">logistic</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X1_train</span><span class="p">,</span> <span class="n">y1_train</span><span class="p">)</span>
<span class="k">print</span> <span class="s2">&quot;----------------&quot;</span>
<span class="k">print</span> <span class="s2">&quot;LOGISTIC REGRESSION CV ACCURACY SCORE&quot;</span>
<span class="k">print</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">logistic</span><span class="p">,</span> <span class="n">X1_train</span><span class="p">,</span> <span class="n">y1_train</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="c1">#Show the r2 score as well.</span>
<span class="k">print</span> <span class="s2">&quot;----------------&quot;</span>
<span class="k">print</span> <span class="s2">&quot;LOGISTIC REGRESSION R2 SCORE&quot;</span>
<span class="k">print</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">logistic</span><span class="p">,</span> <span class="n">X1_train</span><span class="p">,</span> <span class="n">y1_train</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;r2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="c1">#Logistic confusion matrix</span>
<span class="n">y1_pred</span> <span class="o">=</span> <span class="n">logistic</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X1_test</span><span class="p">)</span>
<span class="c1">#CONFUSION MATRIX FOR LOGISTIC REGRESSION CV</span>
<span class="n">confusion</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y1_test</span><span class="p">,</span> <span class="n">y1_pred</span><span class="p">))</span>
<span class="c1"># calculate true positives, the number of 1s correctly predicted to be 1</span>
<span class="k">print</span> <span class="s2">&quot;------------------&quot;</span>
<span class="k">print</span> <span class="s2">&quot;LOGISTIC REGRESSION CONFUSION MATRIX&quot;</span>
<span class="k">print</span> <span class="s2">&quot;TP =&quot;</span><span class="p">,</span> <span class="n">confusion</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># calculate false positives, the number of 0s incorrectly predicted to be 1</span>
<span class="k">print</span> <span class="s2">&quot;FP =&quot;</span><span class="p">,</span> <span class="n">confusion</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># calculate true negatives, the number of 0s correctly predicted to be 0</span>
<span class="k">print</span> <span class="s2">&quot;TN =&quot;</span><span class="p">,</span> <span class="n">confusion</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="c1"># calculate false negatives, the number of 1s incorrectly predicted to be 0</span>
<span class="k">print</span> <span class="s2">&quot;FN =&quot;</span><span class="p">,</span> <span class="n">confusion</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
</pre></div>


<div class="highlight"><pre><span></span>----------------
LOGISTIC REGRESSION CV ACCURACY SCORE
0.65724137931
----------------
LOGISTIC REGRESSION R2 SCORE
-0.41568627451
------------------
LOGISTIC REGRESSION CONFUSION MATRIX
TP = 34
FP = 17
TN = 10
FN = 12
</pre></div>


<div class="highlight"><pre><span></span><span class="n">df_model</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">target</span>
<span class="n">df_model</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>


<div class="highlight"><pre><span></span>0    132
1     87
Name: target, dtype: int64
</pre></div>


<div class="highlight"><pre><span></span><span class="n">logistic_coef</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">logistic</span><span class="o">.</span><span class="n">coef_</span><span class="o">.</span><span class="n">tolist</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">i</span><span class="p">:</span>
        <span class="n">logistic_coef</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<span class="k">print</span> <span class="nb">len</span><span class="p">(</span><span class="n">logistic_coef</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>55
</pre></div>


<div class="highlight"><pre><span></span><span class="n">logistic_coef</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">logistic</span><span class="o">.</span><span class="n">coef_</span><span class="o">.</span><span class="n">tolist</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">i</span><span class="p">:</span>
        <span class="n">logistic_coef</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<span class="k">print</span> <span class="nb">len</span><span class="p">(</span><span class="n">logistic_coef</span><span class="p">)</span>
<span class="n">log_features</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Features&#39;</span><span class="p">,</span> <span class="s1">&#39;Importance (coef)&#39;</span><span class="p">])</span>
<span class="n">log_features</span><span class="p">[</span><span class="s1">&#39;Features&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X1_train</span><span class="o">.</span><span class="n">columns</span>
<span class="n">log_features</span><span class="p">[</span><span class="s1">&#39;Importance (coef)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">logistic_coef</span>
<span class="n">log_features</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Importance (coef)&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#log_features.drop(&#39;Importance (Gini Index)&#39;, axis=1, inplace=True)</span>
<span class="c1">#log_features.drop(0, inplace=True)</span>
<span class="n">log_features</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>


<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Features</th>
      <th>Importance (coef)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>53</th>
      <td>Work Stress_Somewhat stressful</td>
      <td>30.475260</td>
    </tr>
    <tr>
      <th>0</th>
      <td>DATA_keyword</td>
      <td>26.847726</td>
    </tr>
    <tr>
      <th>43</th>
      <td>ANALYST_title</td>
      <td>23.199324</td>
    </tr>
    <tr>
      <th>33</th>
      <td>PROBLEMS_keyword</td>
      <td>21.660053</td>
    </tr>
    <tr>
      <th>13</th>
      <td>SCIENTIST_keyword</td>
      <td>18.722064</td>
    </tr>
  </tbody>
</table>
</div>

<h6>Starting accuracy</h6>
<p>169/(169+45) == 0.789</p>
<p>We have an increase in accuracy here of about 8%.</p>
<h1>VISUALIZATIONS</h1>
<div class="highlight"><pre><span></span><span class="c1">#Number of jobs we analyzed and got salary data for.</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;estimate&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>


<div class="highlight"><pre><span></span>(219, 66)
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#Median salary of our data.</span>
<span class="n">df</span><span class="o">.</span><span class="n">estimate</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
</pre></div>


<div class="highlight"><pre><span></span>76353.39661694401
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#Plot it on a histogram.</span>
<span class="n">df</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;estimate&#39;</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>array([[&lt;matplotlib.axes._subplots.AxesSubplot object at 0x13ac7e710&gt;]], dtype=object)
</pre></div>


<p><img alt="png" src="../images/finding_a_data_science_job_with_data_science/output_119_1.png"></p>
<div class="highlight"><pre><span></span><span class="c1">#Sort the dataframe so that we can have a better output</span>
<span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;estimate&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c1">#Look at the best companies.</span>
<span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">40</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;estimate&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;company&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x133659750&gt;
</pre></div>


<p><img alt="png" src="../images/finding_a_data_science_job_with_data_science/output_120_1.png"></p>
<div class="highlight"><pre><span></span>
</pre></div>


<div class="highlight"><pre><span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1331c3b90&gt;
</pre></div>


<p><img alt="png" src="../images/finding_a_data_science_job_with_data_science/output_121_1.png"></p>
<h1>Do a scatter plot of "likelihood keywords+titles" against salary estimate.</h1>
<div class="highlight"><pre><span></span><span class="c1">#Look at the most important features.</span>
<span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Importance (Gini Index)&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Features&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_features</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">23</span><span class="p">])</span>
</pre></div>


<div class="highlight"><pre><span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x128c0eb90&gt;
</pre></div>


<p><img alt="png" src="../images/finding_a_data_science_job_with_data_science/output_123_1.png"></p>
<div class="highlight"><pre><span></span><span class="n">df_features</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">50</span><span class="p">]</span>
</pre></div>


<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Features</th>
      <th>Importance (Gini Index)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>18</th>
      <td>DATA SCIENTIST_keyword</td>
      <td>0.049955</td>
    </tr>
    <tr>
      <th>12</th>
      <td>STATISTICAL_keyword</td>
      <td>0.049172</td>
    </tr>
    <tr>
      <th>47</th>
      <td>ENGINEER_title</td>
      <td>0.043087</td>
    </tr>
    <tr>
      <th>45</th>
      <td>SENIOR_title</td>
      <td>0.038337</td>
    </tr>
    <tr>
      <th>48</th>
      <td>likelihood_title</td>
      <td>0.038186</td>
    </tr>
    <tr>
      <th>7</th>
      <td>SCIENCE_keyword</td>
      <td>0.036519</td>
    </tr>
    <tr>
      <th>28</th>
      <td>WORKING_keyword</td>
      <td>0.035016</td>
    </tr>
    <tr>
      <th>27</th>
      <td>COMPANY_keyword</td>
      <td>0.034195</td>
    </tr>
    <tr>
      <th>33</th>
      <td>ALGORITHMS_keyword</td>
      <td>0.032109</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ANALYTICS_keyword</td>
      <td>0.030765</td>
    </tr>
    <tr>
      <th>46</th>
      <td>RESEARCH ANALYST_title</td>
      <td>0.029616</td>
    </tr>
    <tr>
      <th>34</th>
      <td>PROBLEMS_keyword</td>
      <td>0.029420</td>
    </tr>
    <tr>
      <th>22</th>
      <td>YEARS_keyword</td>
      <td>0.028194</td>
    </tr>
    <tr>
      <th>26</th>
      <td>TECHNICAL_keyword</td>
      <td>0.028128</td>
    </tr>
    <tr>
      <th>41</th>
      <td>DATA_title</td>
      <td>0.025736</td>
    </tr>
    <tr>
      <th>9</th>
      <td>LEARNING_keyword</td>
      <td>0.023099</td>
    </tr>
    <tr>
      <th>53</th>
      <td>Work Stress_Highly stressful</td>
      <td>0.021466</td>
    </tr>
    <tr>
      <th>13</th>
      <td>MACHINE_keyword</td>
      <td>0.020744</td>
    </tr>
    <tr>
      <th>44</th>
      <td>ANALYST_title</td>
      <td>0.020652</td>
    </tr>
    <tr>
      <th>36</th>
      <td>LARGE_keyword</td>
      <td>0.020500</td>
    </tr>
    <tr>
      <th>43</th>
      <td>RESEARCH_title</td>
      <td>0.020026</td>
    </tr>
    <tr>
      <th>10</th>
      <td>SKILLS_keyword</td>
      <td>0.018685</td>
    </tr>
    <tr>
      <th>14</th>
      <td>SCIENTIST_keyword</td>
      <td>0.018643</td>
    </tr>
    <tr>
      <th>35</th>
      <td>STRONG_keyword</td>
      <td>0.018581</td>
    </tr>
    <tr>
      <th>0</th>
      <td>desc_len</td>
      <td>0.017105</td>
    </tr>
    <tr>
      <th>39</th>
      <td>likelihood_keyword</td>
      <td>0.017065</td>
    </tr>
    <tr>
      <th>25</th>
      <td>DEVELOPMENT_keyword</td>
      <td>0.016854</td>
    </tr>
    <tr>
      <th>29</th>
      <td>MODELS_keyword</td>
      <td>0.016477</td>
    </tr>
    <tr>
      <th>42</th>
      <td>DATA SCIENTIST_title</td>
      <td>0.016293</td>
    </tr>
    <tr>
      <th>16</th>
      <td>MACHINE LEARNING_keyword</td>
      <td>0.015944</td>
    </tr>
    <tr>
      <th>8</th>
      <td>TEAM_keyword</td>
      <td>0.015683</td>
    </tr>
    <tr>
      <th>19</th>
      <td>DATA SCIENCE_keyword</td>
      <td>0.015024</td>
    </tr>
    <tr>
      <th>21</th>
      <td>RESEARCH_keyword</td>
      <td>0.014750</td>
    </tr>
    <tr>
      <th>23</th>
      <td>TOOLS_keyword</td>
      <td>0.012869</td>
    </tr>
    <tr>
      <th>11</th>
      <td>NEW_keyword</td>
      <td>0.012513</td>
    </tr>
    <tr>
      <th>24</th>
      <td>INFORMATION_keyword</td>
      <td>0.012495</td>
    </tr>
    <tr>
      <th>30</th>
      <td>INCLUDING_keyword</td>
      <td>0.011906</td>
    </tr>
    <tr>
      <th>40</th>
      <td>SCIENTIST_title</td>
      <td>0.011582</td>
    </tr>
    <tr>
      <th>37</th>
      <td>KNOWLEDGE_keyword</td>
      <td>0.011511</td>
    </tr>
    <tr>
      <th>17</th>
      <td>SOLUTIONS_keyword</td>
      <td>0.010887</td>
    </tr>
    <tr>
      <th>15</th>
      <td>ABILITY_keyword</td>
      <td>0.009985</td>
    </tr>
    <tr>
      <th>38</th>
      <td>METHODS_keyword</td>
      <td>0.008828</td>
    </tr>
    <tr>
      <th>31</th>
      <td>TECHNOLOGY_keyword</td>
      <td>0.006824</td>
    </tr>
    <tr>
      <th>6</th>
      <td>BUSINESS_keyword</td>
      <td>0.006701</td>
    </tr>
    <tr>
      <th>51</th>
      <td>Job Satisfaction_Highly satisfied</td>
      <td>0.006249</td>
    </tr>
    <tr>
      <th>20</th>
      <td>USING_keyword</td>
      <td>0.005854</td>
    </tr>
    <tr>
      <th>32</th>
      <td>JOB_keyword</td>
      <td>0.005231</td>
    </tr>
    <tr>
      <th>55</th>
      <td>Work Stress_Stressful</td>
      <td>0.003666</td>
    </tr>
    <tr>
      <th>5</th>
      <td>ANALYSIS_keyword</td>
      <td>0.003363</td>
    </tr>
    <tr>
      <th>2</th>
      <td>EXPERIENCE_keyword</td>
      <td>0.002129</td>
    </tr>
  </tbody>
</table>
</div>

<div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ds_ratio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;estimate&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;likelihood_keyword&#39;</span><span class="p">]</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;ds_in_title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;ds_in_title&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span> <span class="k">if</span> <span class="n">x</span> <span class="k">else</span> <span class="mf">0.0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;estimate&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">85000</span><span class="p">]</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>


<div class="highlight"><pre><span></span>Index([u&#39;title&#39;, u&#39;company&#39;, u&#39;url&#39;, u&#39;location&#39;, u&#39;desc&#39;, u&#39;1-4&#39;,
       u&#39;Job Flexibility&#39;, u&#39;Job Satisfaction&#39;, u&#39;Vacation Weeks&#39;,
       u&#39;Work Stress&#39;, u&#39;desc_len&#39;, u&#39;ds_in_title&#39;, u&#39;desc_test&#39;,
       u&#39;title_test&#39;, u&#39;DATA_keyword&#39;, u&#39;EXPERIENCE_keyword&#39;, u&#39;WORK_keyword&#39;,
       u&#39;ANALYTICS_keyword&#39;, u&#39;ANALYSIS_keyword&#39;, u&#39;BUSINESS_keyword&#39;,
       u&#39;SCIENCE_keyword&#39;, u&#39;TEAM_keyword&#39;, u&#39;LEARNING_keyword&#39;,
       u&#39;SKILLS_keyword&#39;, u&#39;NEW_keyword&#39;, u&#39;STATISTICAL_keyword&#39;,
       u&#39;MACHINE_keyword&#39;, u&#39;SCIENTIST_keyword&#39;, u&#39;ABILITY_keyword&#39;,
       u&#39;MACHINE LEARNING_keyword&#39;, u&#39;SOLUTIONS_keyword&#39;,
       u&#39;DATA SCIENTIST_keyword&#39;, u&#39;DATA SCIENCE_keyword&#39;, u&#39;USING_keyword&#39;,
       u&#39;RESEARCH_keyword&#39;, u&#39;YEARS_keyword&#39;, u&#39;TOOLS_keyword&#39;,
       u&#39;INFORMATION_keyword&#39;, u&#39;DEVELOPMENT_keyword&#39;, u&#39;TECHNICAL_keyword&#39;,
       u&#39;COMPANY_keyword&#39;, u&#39;WORKING_keyword&#39;, u&#39;MODELS_keyword&#39;,
       u&#39;INCLUDING_keyword&#39;, u&#39;TECHNOLOGY_keyword&#39;, u&#39;JOB_keyword&#39;,
       u&#39;ALGORITHMS_keyword&#39;, u&#39;PROBLEMS_keyword&#39;, u&#39;STRONG_keyword&#39;,
       u&#39;LARGE_keyword&#39;, u&#39;KNOWLEDGE_keyword&#39;, u&#39;METHODS_keyword&#39;,
       u&#39;likelihood_keyword&#39;, u&#39;SCIENTIST_title&#39;, u&#39;DATA_title&#39;,
       u&#39;DATA SCIENTIST_title&#39;, u&#39;RESEARCH_title&#39;, u&#39;ANALYST_title&#39;,
       u&#39;SENIOR_title&#39;, u&#39;RESEARCH ANALYST_title&#39;, u&#39;ENGINEER_title&#39;,
       u&#39;likelihood_title&#39;, u&#39;post_estimate&#39;, u&#39;co_weight&#39;,
       u&#39;weighted_estimate&#39;, u&#39;estimate&#39;, u&#39;ds_ratio&#39;, u&#39;target&#39;],
      dtype=&#39;object&#39;)
</pre></div>


<div class="highlight"><pre><span></span><span class="n">X2_test</span><span class="o">.</span><span class="n">columns</span>
</pre></div>


<div class="highlight"><pre><span></span>Index([u&#39;title&#39;, u&#39;company&#39;, u&#39;url&#39;, u&#39;location&#39;, u&#39;desc&#39;, u&#39;Job Flexibility&#39;,
       u&#39;Job Satisfaction&#39;, u&#39;Vacation Weeks&#39;, u&#39;Work Stress&#39;, u&#39;desc_len&#39;,
       u&#39;ds_in_title&#39;, u&#39;desc_test&#39;, u&#39;title_test&#39;, u&#39;DATA_keyword&#39;,
       u&#39;EXPERIENCE_keyword&#39;, u&#39;WORK_keyword&#39;, u&#39;ANALYTICS_keyword&#39;,
       u&#39;ANALYSIS_keyword&#39;, u&#39;BUSINESS_keyword&#39;, u&#39;SCIENCE_keyword&#39;,
       u&#39;TEAM_keyword&#39;, u&#39;LEARNING_keyword&#39;, u&#39;SKILLS_keyword&#39;, u&#39;NEW_keyword&#39;,
       u&#39;STATISTICAL_keyword&#39;, u&#39;MACHINE_keyword&#39;, u&#39;SCIENTIST_keyword&#39;,
       u&#39;ABILITY_keyword&#39;, u&#39;MACHINE LEARNING_keyword&#39;, u&#39;SOLUTIONS_keyword&#39;,
       u&#39;DATA SCIENTIST_keyword&#39;, u&#39;DATA SCIENCE_keyword&#39;, u&#39;USING_keyword&#39;,
       u&#39;RESEARCH_keyword&#39;, u&#39;YEARS_keyword&#39;, u&#39;TOOLS_keyword&#39;,
       u&#39;INFORMATION_keyword&#39;, u&#39;DEVELOPMENT_keyword&#39;, u&#39;TECHNICAL_keyword&#39;,
       u&#39;COMPANY_keyword&#39;, u&#39;WORKING_keyword&#39;, u&#39;MODELS_keyword&#39;,
       u&#39;INCLUDING_keyword&#39;, u&#39;TECHNOLOGY_keyword&#39;, u&#39;JOB_keyword&#39;,
       u&#39;ALGORITHMS_keyword&#39;, u&#39;PROBLEMS_keyword&#39;, u&#39;STRONG_keyword&#39;,
       u&#39;LARGE_keyword&#39;, u&#39;KNOWLEDGE_keyword&#39;, u&#39;METHODS_keyword&#39;,
       u&#39;likelihood_keyword&#39;, u&#39;SCIENTIST_title&#39;, u&#39;DATA_title&#39;,
       u&#39;DATA SCIENTIST_title&#39;, u&#39;RESEARCH_title&#39;, u&#39;ANALYST_title&#39;,
       u&#39;SENIOR_title&#39;, u&#39;RESEARCH ANALYST_title&#39;, u&#39;ENGINEER_title&#39;,
       u&#39;likelihood_title&#39;, u&#39;co_weight&#39;, u&#39;predicted&#39;],
      dtype=&#39;object&#39;)
</pre></div>


<div class="highlight"><pre><span></span><span class="n">X2_test</span><span class="p">[</span><span class="s1">&#39;predicted&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y2_pred</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#Scatter plot analysis</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s2">&quot;notebook&quot;</span><span class="p">,</span> <span class="n">font_scale</span><span class="o">=</span><span class="mf">1.1</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;ticks&quot;</span><span class="p">)</span>


<span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="s1">&#39;predicted&#39;</span><span class="p">,</span> <span class="s1">&#39;estimate&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">X2_test</span><span class="p">,</span> <span class="n">fit_reg</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">scatter_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;marker&quot;</span><span class="p">:</span> <span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Scatter Plot Analysis&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;DS_Likelihood&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Title_Likelihood&#39;</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>&lt;matplotlib.text.Text at 0x12e97cd90&gt;
</pre></div>


<p><img alt="png" src="../images/finding_a_data_science_job_with_data_science/output_131_1.png"></p>
<div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;company&#39;</span><span class="p">,</span><span class="s1">&#39;likelihood_keyword&#39;</span><span class="p">,</span> <span class="s1">&#39;ds_in_title&#39;</span><span class="p">]]</span>
</pre></div>


<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>company</th>
      <th>likelihood_keyword</th>
      <th>ds_in_title</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>262</th>
      <td>Smith Hanley Associates</td>
      <td>0.611106</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1256</th>
      <td>UCB</td>
      <td>0.700532</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1336</th>
      <td>Facebook</td>
      <td>0.616334</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>44</th>
      <td>Solebrity, Inc.</td>
      <td>0.598436</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>765</th>
      <td>Dovel Technologies</td>
      <td>0.616292</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>510</th>
      <td>Dept of Forensic Sciences</td>
      <td>0.671009</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>475</th>
      <td>Dept of Forensic Sciences</td>
      <td>0.651485</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>688</th>
      <td>The Aerospace Corporation</td>
      <td>0.637496</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1062</th>
      <td>The Aerospace Corporation</td>
      <td>0.610304</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>994</th>
      <td>The Aerospace Corporation</td>
      <td>0.526587</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>55</th>
      <td>The Aerospace Corporation</td>
      <td>0.660001</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>533</th>
      <td>Exponent</td>
      <td>0.537793</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>697</th>
      <td>Exponent</td>
      <td>0.536683</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2024</th>
      <td>Celgene</td>
      <td>0.603297</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2101</th>
      <td>Celgene</td>
      <td>0.570444</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1882</th>
      <td>Celgene Corporation</td>
      <td>0.658505</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1562</th>
      <td>Celgene</td>
      <td>0.547107</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2015</th>
      <td>Celgene Corporation</td>
      <td>0.633491</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2091</th>
      <td>Celgene Corporation</td>
      <td>0.603297</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1679</th>
      <td>Celgene</td>
      <td>0.648625</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1808</th>
      <td>Celgene</td>
      <td>0.658505</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2119</th>
      <td>Celgene Corporation</td>
      <td>0.522608</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>951</th>
      <td>Bloomberg BNA</td>
      <td>0.563972</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1933</th>
      <td>Genzyme</td>
      <td>0.530128</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Department of Health</td>
      <td>0.558110</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1385</th>
      <td>Scienaptic Systems Inc</td>
      <td>0.674084</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1890</th>
      <td>Driversiti</td>
      <td>0.576417</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1922</th>
      <td>OppenheimerFunds</td>
      <td>0.630253</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1269</th>
      <td>McKinsey &amp; Company</td>
      <td>0.721504</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1068</th>
      <td>Centers for Disease Control and Preven...</td>
      <td>0.530710</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>71</th>
      <td>Teaching Strategies, LLC</td>
      <td>0.636353</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>107</th>
      <td>Truth Initiative</td>
      <td>0.712770</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1596</th>
      <td>New York Life Insurance Co</td>
      <td>0.684175</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1340</th>
      <td>New York Life Insurance Co</td>
      <td>0.565238</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1554</th>
      <td>New York Life Insurance Co</td>
      <td>0.707351</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>527</th>
      <td>Altamira Technologies Corporation</td>
      <td>0.637990</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>56</th>
      <td>Altamira Technologies Corporation</td>
      <td>0.557730</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>906</th>
      <td>Altamira Technologies Corporation</td>
      <td>0.617774</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>270</th>
      <td>Altamira Technologies Corporation</td>
      <td>0.637990</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>752</th>
      <td>Conservation International</td>
      <td>0.575591</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>92</th>
      <td>Altamira Technologies Corporation</td>
      <td>0.613087</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1097</th>
      <td>ASSURANT</td>
      <td>0.684795</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>509</th>
      <td>University of Maryland</td>
      <td>0.573420</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>600</th>
      <td>OnPoint Consulting, Inc.</td>
      <td>0.653654</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1518</th>
      <td>ISO</td>
      <td>0.704586</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1657</th>
      <td>ISO</td>
      <td>0.642413</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>311</th>
      <td>Synchronoss Technologies, Inc.</td>
      <td>0.674990</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>469</th>
      <td>Meso Scale Diagnostics</td>
      <td>0.552441</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>351</th>
      <td>Meso Scale Diagnostics</td>
      <td>0.594435</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2031</th>
      <td>Teva Pharmaceuticals</td>
      <td>0.626989</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>917</th>
      <td>United Educators</td>
      <td>0.623457</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2026</th>
      <td>RM Dayton Analytics, Ltd. Co.</td>
      <td>0.553595</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>314</th>
      <td>Veteran Staffing Network of Easter Seals</td>
      <td>0.598300</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1440</th>
      <td>Averity</td>
      <td>0.594164</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1546</th>
      <td>Selby Jennings</td>
      <td>0.584915</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1754</th>
      <td>Harnham</td>
      <td>0.624282</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>927</th>
      <td>IHS Markit</td>
      <td>0.828642</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1000</th>
      <td>The Wallach Search Group</td>
      <td>0.685785</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1809</th>
      <td>Harnham</td>
      <td>0.665668</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>577</th>
      <td>RockHammer Talent Solutions</td>
      <td>0.561362</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>219 rows × 3 columns</p>
</div>

<div class="highlight"><pre><span></span>
</pre></div>


<div class="highlight"><pre><span></span>
</pre></div>
</div>
    <aside>
    <div class="bug-reporting__panel">
        <h3>Find a typo or bug? Have a suggestion?</h3></br>
        <p><a href="https://twitter.com/intent/tweet?screen_name=halluvagoodtime" class="twitter-mention-button" data-show-count="false", target="_blank">Tweet to @halluvagoodtime.</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script></p></br>
        <p>Or... you can see the code here and <a href="https://github.com/nathan-hall/nathan-hall.github.io", target="_blank">submit an issue.</a></p>
    </div>
    </aside>
  </div>
  </div>
</section>

        <div class="push"></div>
    </div>
    <!-- start of footer section -->




    <footer class="footer">
      <p class="text-muted">
          <center><!--This project contains 21 pages and is available on <a href="https://github.com/nathan-hall/nathan-hall.github.io">Github</a>.</br>-->
          To learn more about Nate, <a href="../pages/about_nate.html">click here</a></br> <!--Or, send him a tweet <a href="https://twitter.com/intent/tweet?screen_name=halluvagoodtime" class="twitter-mention-button" data-show-count="false", target="_blank">@halluvagoodtime.</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script></br></br>-->
          Copyright &copy; Nate Hall
              <time datetime="2017">2017</time>.
          </center>
      </p>
    </footer>


    <!--<footer class="footer">
        <div class="container">
            <p class="text-muted">
                <center>--> <!--This project contains 21 pages and is available on <a href="https://github.com/nathan-hall/nathan-hall.github.io">Github</a>.</br>-->
                <!--To learn more about Nate, <a href="../pages/about_nate.html">click here</a></br>--> <!--Or, send him a tweet <a href="https://twitter.com/intent/tweet?screen_name=halluvagoodtime" class="twitter-mention-button" data-show-count="false", target="_blank">@halluvagoodtime.</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script></br></br>-->
                <!--Copyright &copy; Nate Hall
                    <time datetime="2017">2017</time>.
                </center>
            </p>
        </div>
    </footer>-->

    <!-- This jQuery line finds any span that contains code highlighting classes and then selects the parent <pre> tag and adds a border. This is done as a workaround to visually distinguish the code inputs and outputs -->
    <script>
        $( ".hll, .n, .c, .err, .k, .o, .cm, .cp, .c1, .cs, .gd, .ge, .gr, .gh, .gi, .go, .gp, .gs, .gu, .gt, .kc, .kd, .kn, .kp, .kr, .kt, .m, .s, .na, .nb, .nc, .no, .nd, .ni, .ne, .nf, .nl, .nn, .nt, .nv, .ow, .w, .mf, .mh, .mi, .mo, .sb, .sc, .sd, .s2, .se, .sh, .si, .sx, .sr, .s1, .ss, .bp, .vc, .vg, .vi, .il" ).parent( "pre" ).css( "border", "1px solid #DEDEDE" );
    </script>

    <!-- Load Google Analytics -->
    <script>
        (function(i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r;
            i[r] = i[r] || function() {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o),
                m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m)
        })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-87671349-1', 'auto');
        ga('send', 'pageview');
    </script>
    <!-- End of Google Analytics -->

    <!-- Bootstrap core JavaScript
      ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../theme/js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../theme/js/ie10-viewport-bug-workaround.js"></script>
</body>

</html>